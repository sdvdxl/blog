<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>杜龙少的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="杜龙少的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="杜龙少的博客">
<meta property="og:url" content="http://todu.top/index.html">
<meta property="og:site_name" content="杜龙少的博客">
<meta property="og:description" content="杜龙少的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="杜龙少的博客">
<meta name="twitter:description" content="杜龙少的博客">
  
    <link rel="alternative" href="/atom.xml" title="杜龙少的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favorite.ico">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/me.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">杜龙少</a></h1>
        </hgroup>

        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">博客首页</a></li>
                        
                            <li><a href="/tags">分类|标签</a></li>
                        
                            <li><a href="javascript:;">备案：鲁ICP备17022134号</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github" target="_blank" href="https://github.com/sdvdxl" title="github">github</a>
                            
                                <a class="fl linkedin" target="_blank" href="http://www.linkedin.com/in/sdvdxl" title="linkedin">linkedin</a>
                            
                                <a class="fl weibo" target="_blank" href="http://weibo.com/sdvdxl" title="weibo">weibo</a>
                            
                                <a class="fl twitter" target="_blank" href="https://twitter.com/sdvdxl" title="twitter">twitter</a>
                            
                                <a class="fl facebook" target="_blank" href="https://www.facebook.com/sdvdxl" title="facebook">facebook</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/API/" style="font-size: 10px;">API</a> <a href="/tags/RESTFul/" style="font-size: 10px;">RESTFul</a> <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/arch/" style="font-size: 11.43px;">arch</a> <a href="/tags/archlinux/" style="font-size: 11.43px;">archlinux</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/gnome/" style="font-size: 10px;">gnome</a> <a href="/tags/go/" style="font-size: 18.57px;">go</a> <a href="/tags/golang/" style="font-size: 20px;">golang</a> <a href="/tags/hadoop/" style="font-size: 15.71px;">hadoop</a> <a href="/tags/hbase/" style="font-size: 10px;">hbase</a> <a href="/tags/hdfs/" style="font-size: 17.14px;">hdfs</a> <a href="/tags/hive/" style="font-size: 10px;">hive</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/jdk/" style="font-size: 10px;">jdk</a> <a href="/tags/jrebel/" style="font-size: 10px;">jrebel</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/linux/" style="font-size: 15.71px;">linux</a> <a href="/tags/mysql/" style="font-size: 12.86px;">mysql</a> <a href="/tags/ntfs/" style="font-size: 10px;">ntfs</a> <a href="/tags/sbt/" style="font-size: 10px;">sbt</a> <a href="/tags/scala/" style="font-size: 11.43px;">scala</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/spark/" style="font-size: 15.71px;">spark</a> <a href="/tags/spark-streaming/" style="font-size: 11.43px;">spark-streaming</a> <a href="/tags/spring/" style="font-size: 15.71px;">spring</a> <a href="/tags/spring-xd/" style="font-size: 17.14px;">spring xd</a> <a href="/tags/spring-xd/" style="font-size: 12.86px;">spring-xd</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/sqoop/" style="font-size: 11.43px;">sqoop</a> <a href="/tags/windows8/" style="font-size: 10px;">windows8</a> <a href="/tags/xd/" style="font-size: 14.29px;">xd</a> <a href="/tags/zookeeper/" style="font-size: 11.43px;">zookeeper</a> <a href="/tags/博客/" style="font-size: 10px;">博客</a> <a href="/tags/安卓/" style="font-size: 10px;">安卓</a> <a href="/tags/异常/" style="font-size: 10px;">异常</a> <a href="/tags/录音/" style="font-size: 10px;">录音</a> <a href="/tags/端口/" style="font-size: 10px;">端口</a> <a href="/tags/软件/" style="font-size: 10px;">软件</a> <a href="/tags/进程/" style="font-size: 10px;">进程</a> <a href="/tags/错误/" style="font-size: 10px;">错误</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://MOxFIVE.github.io/">MOxFIVE</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.vsay.cn/">DoubleV</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.ccwebsite.com/">兮兮</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.dandyweng.com/">翁天信</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.plqblog.com/views/index.php">潘利强</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.hankin.cn/">hankin</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.waydrow.com/">waydrow</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">喜欢接触新鲜事物、迎接新的挑战</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">杜龙少</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/me.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">杜龙少</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">博客首页</a></li>
                
                    <li><a href="/tags">分类|标签</a></li>
                
                    <li><a href="javascript:;">备案：鲁ICP备17022134号</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/sdvdxl" title="github">github</a>
                    
                        <a class="linkedin" target="_blank" href="http://www.linkedin.com/in/sdvdxl" title="linkedin">linkedin</a>
                    
                        <a class="weibo" target="_blank" href="http://weibo.com/sdvdxl" title="weibo">weibo</a>
                    
                        <a class="twitter" target="_blank" href="https://twitter.com/sdvdxl" title="twitter">twitter</a>
                    
                        <a class="facebook" target="_blank" href="https://www.facebook.com/sdvdxl" title="facebook">facebook</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-other/RESTFul-API-错误的设计" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/other/RESTFul-API-错误的设计/" class="article-date">
      <time datetime="2017-05-13T15:15:53.000Z" itemprop="datePublished">2017-05-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/other/RESTFul-API-错误的设计/">RESTFul API 错误的设计</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>不管是WEB还是移动端，如果需要调用Http接口，那么不可避免要处理各种错误，包括客户端参数完整性校验，类型校验，系统错误等。如果一个设计规范的接口错误返回值，不但可以规范调用方统一处理方式，给出更合理的提示，而且后端也有着接口返回规范的作用。这里讨论的其实并不单纯是返回的错误设计，也包括业务上的错误设计。</p>
<h1 id="接口返回设计"><a href="#接口返回设计" class="headerlink" title="接口返回设计"></a>接口返回设计</h1><p>接口返回需要有http status，错误说明，并且要提供一个完整的错误列表，可以通过简单的错误说明或者错误代码查阅到详细的错误原因。简要错误说明可以只包含简短的文字描述，可以包含错误代码。如果说哪种方式更为合理，我更倾向于错误代码+简要错误说明。如果只有简要错误说明，这个错误描述可能有些描述不合理，如果后端改了说明，那么对应的错误映射也要更改，调用方也要跟着修改。如果只有错误代码，调用方难以一眼看出错误原因，需要查阅错误码，这个比较啰嗦。如果同时提供错误码和简要错误说明，调用方可以通过简要说明快速定位问题，如果要处理错误逻辑，根据错误码表映射即可，这样即使描述改变了，但是错误码是永久不变的，不会影响调用方的处理逻辑。返回的结构如下：<br><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">HTTP/1.1 <span class="number">200</span> OK</div><div class="line"><span class="attribute">Content-Type</span>: application/json;charset=UTF-8</div><div class="line"></div><div class="line"><span class="go">&#123;</span></div><div class="line">	<span class="string">"msg"</span>: <span class="string">"错误说明"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="服务端错误设计和处理"><a href="#服务端错误设计和处理" class="headerlink" title="服务端错误设计和处理"></a>服务端错误设计和处理</h1><p>根据RESTful接口的http status，对于错误，可以分为以下几大类（常用）：</p>
<ol>
<li>权限错误 401</li>
<li>参数错误 400</li>
<li>重复，冲突 409</li>
<li>找不到资源 404</li>
<li>服务器错误 500</li>
</ol>
<p>对于以上5中分类，除了第5种系统服务器错误外，其余四种我们可以分别设计一个错误（异常）类型。至于第5中服务器错误为什么不需要，因为我们需要根据上面四种错误是需要单独判断的，如果不在上面的类型中，直接返回500即可。对于上面的错误，在返回或者抛出的时候，应该具体到原因，比如： 参数错误，要写明哪里错误，是手机号不合法还是邮箱不合法，还是哪个参数类型不对，这样便于调用方定位问题。</p>
<p>以Java为例，我们可以定义以下异常：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthExcepption</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</div><div class="line">	<span class="keyword">protected</span> <span class="keyword">int</span> code;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">AuthExcepption</span><span class="params">(<span class="keyword">int</span> code, String msg)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.code = code;</div><div class="line">		<span class="keyword">super</span>(msg);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCode</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> code;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 对于其他三个也是这个格式。</span></div><div class="line"><span class="comment">// IllegalArgumentException</span></div><div class="line"><span class="comment">// DuplicatedException</span></div><div class="line"><span class="comment">// NotFoundException</span></div></pre></td></tr></table></figure></p>
<p>在做异常统一处理的时候，可以判断极少的类型即可，下面是 spring mvc 的统一异常处理方式：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Body</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> code;</div><div class="line">	<span class="keyword">private</span> String msg;</div><div class="line">	<span class="comment">// setter and getter</span></div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Body</span><span class="params">(<span class="keyword">int</span> code, String msg)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.code = code;</div><div class="line">		<span class="keyword">this</span>.msg = msg;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@ExceptionHandler</span>(value = &#123;AuthExcepption.class&#125;)</div><div class="line"><span class="function"><span class="keyword">public</span> ResponseEntity&lt;Object&gt; <span class="title">handleAuthExcepption</span><span class="params">(AuthExcepption ex, WebRequest request)</span> </span>&#123;</div><div class="line">	<span class="comment">// 记录日志</span></div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity(<span class="keyword">new</span> Body(ex.getCode(),ex.getMessage()),HttpStatus.UNAUTHORIZED);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@ExceptionHandler</span>(value = &#123;IllegalArgumentException.class&#125;)</div><div class="line"><span class="function"><span class="keyword">public</span> ResponseEntity&lt;Object&gt; <span class="title">handleIllegalArgumentException</span><span class="params">(IllegalArgumentException ex, WebRequest request)</span> </span>&#123;</div><div class="line">	<span class="comment">// 记录日志</span></div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity(<span class="keyword">new</span> Body(ex.getCode(),ex.getMessage()), HttpStatus.BAD_REQUEST);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@ExceptionHandler</span>(value = &#123;DuplicatedException.class&#125;)</div><div class="line"><span class="function"><span class="keyword">public</span> ResponseEntity&lt;Object&gt; <span class="title">handleIllegalArgumentException</span><span class="params">(DuplicatedException ex, WebRequest request)</span> </span>&#123;</div><div class="line">	<span class="comment">// 记录日志</span></div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity(<span class="keyword">new</span> Body(ex.getCode(),ex.getMessage()), HttpStatus.CONFLICT);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@ExceptionHandler</span>(value = &#123;NotFoundException.class&#125;)</div><div class="line"><span class="function"><span class="keyword">public</span> ResponseEntity&lt;Object&gt; <span class="title">handleIllegalArgumentException</span><span class="params">(NotFoundException ex, WebRequest request)</span> </span>&#123;</div><div class="line">	<span class="comment">// 记录日志</span></div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity(<span class="keyword">new</span> Body(ex.getCode(),ex.getMessage()),HttpStatus.NOT_FOUND);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在业务层那么需要这么处理，抛出一种异常，附带具体的错误码和简要消息：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">(User user)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (!isValid(user.getPhone())) &#123;</div><div class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="number">10001</span>,<span class="string">"手机："</span>+user.getPhone()+<span class="string">" 不合法"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在上面的业务处理示例中，我们采用了传递错误码的形式，另一种处理方式是定义一个该错误码对应的异常，比如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PhoneIllegalException</span> <span class="keyword">extends</span> <span class="title">IllegalArgumentException</span></span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">PhoneIllegalException</span> <span class="params">(String msg)</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>(<span class="number">10001</span>,msg);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>然后业务层就可以直接抛出此异常了：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">(User user)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (!isValid(user.getPhone())) &#123;</div><div class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> PhoneIllegalException(<span class="string">"手机："</span>+user.getPhone()+<span class="string">" 不合法"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/API/">API</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RESTFul/">RESTFul</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/异常/">异常</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/错误/">错误</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-hadoop/安装hbase分布式集群" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/hadoop/安装hbase分布式集群/" class="article-date">
      <time datetime="2017-02-15T09:44:43.000Z" itemprop="datePublished">2017-02-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/hadoop/安装hbase分布式集群/">安装Hbase分布式集群</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><strong>以下操作都是在hadoop这个用户下</strong></p>
<ol>
<li>下载最新版hbase，放到/home/hadoop目录下，解压，生成目录 hbase-1.2.4</li>
<li>下载zookeeper，放到 /home/hadoop/zookeeper-3.4.9， 解压生成 zookeeper-3.4.9 目录</li>
<li>编辑conf下hbase-site.xml<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">  <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.rootdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://master:9000/hbase<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.cluster.distributed<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master,slave1,slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.zookeeper.property.dataDir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/hadoop/zookeeper-3.4.9<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>其中 <code>hbase.zookeeper.quorum</code> 配置是hbase集群机器的名字，上面的值代表在master，slave1，和slave2上启动hbase和zookeeper<br><code>hbase.zookeeper.property.dataDir</code> 是用于配置zookeeper安装目录的，这里我把zookeeper安装到了 <code>/home/hadoop/zookeeper-3.4.9</code>    </p>
<ol>
<li>修改 conf下 hbase-env.sh<br>修改JAVA_HOME，将其指向具体的java安装目录，（最小版本要求是1.7）</li>
<li><p>启动hbase</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bin/start-hbase.sh</div></pre></td></tr></table></figure>
</li>
<li><p>测试<br>输入 <code>bin/hbase shell</code> 进入交互环境，</p>
</li>
</ol>
<ul>
<li>创建表 <code>create &#39;t1&#39;,{NAME =&gt; &#39;f1&#39;, VERSIONS =&gt; 2},{NAME =&gt; &#39;f2&#39;, VERSIONS =&gt; 2}</code></li>
<li>列出表 <code>list</code><br>如果没有出错那么安装成功。</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hadoop/">hadoop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hbase/">hbase</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-域名说明" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/域名说明/" class="article-date">
      <time datetime="2017-02-15T03:02:30.000Z" itemprop="datePublished">2017-02-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/域名说明/">域名说明</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>由于该域名尚未备案，导致不能正常访问文章，请切换到域名 <a href="http://du.uke.wiki" target="_blank" rel="external">http://du.uke.wiki</a>访问。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-linux/Gnome-Shell插件" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/linux/Gnome-Shell插件/" class="article-date">
      <time datetime="2016-08-02T08:24:18.000Z" itemprop="datePublished">2016-08-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/linux/Gnome-Shell插件/">Gnome-Shell插件</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="状态栏菜单按钮"><a href="#状态栏菜单按钮" class="headerlink" title="状态栏菜单按钮"></a><a href="https://extensions.gnome.org/extension/327/axe-menu/" target="_blank" rel="external">状态栏菜单按钮</a></h2><p><img src="http://public-links.qiniudn.com/gnome-shell-menu.png" alt=""></p>
<h2 id="Dock"><a href="#Dock" class="headerlink" title="Dock"></a><a href="https://extensions.gnome.org/extension/307/dash-to-dock/" target="_blank" rel="external">Dock</a></h2><p><img src="http://public-links.qiniudn.com/gnome-shell-dock.png" alt=""></p>
<h2 id="状态栏音乐控制"><a href="#状态栏音乐控制" class="headerlink" title="状态栏音乐控制"></a><a href="https://extensions.gnome.org/extension/55/media-player-indicator/" target="_blank" rel="external">状态栏音乐控制</a></h2><p><img src="http://public-links.qiniudn.com/gnome-shell-media-player-indicator.png" alt=""></p>
<h2 id="菜单列表"><a href="#菜单列表" class="headerlink" title="菜单列表"></a><a href="https://extensions.gnome.org/extension/6/applications-menu/" target="_blank" rel="external">菜单列表</a></h2><p><img src="http://public-links.qiniudn.com/gnome-shell-applications-menu.png" alt=""></p>
<h2 id="Tab-切换"><a href="#Tab-切换" class="headerlink" title="Tab 切换"></a><a href="https://extensions.gnome.org/extension/15/alternatetab/" target="_blank" rel="external">Tab 切换</a></h2><p><img src="http://public-links.qiniudn.com/gnome-shell-alternatetab.png" alt=""></p>
<h2 id="任务栏"><a href="#任务栏" class="headerlink" title="任务栏"></a><a href="https://extensions.gnome.org/extension/584/taskbar/" target="_blank" rel="external">任务栏</a></h2><p><img src="http://public-links.qiniudn.com/gnome-shell-taskbar.png" alt=""></p>
<h2 id="状态栏数字键-大写键状态"><a href="#状态栏数字键-大写键状态" class="headerlink" title="状态栏数字键+大写键状态"></a><a href="https://extensions.gnome.org/extension/36/lock-keys/" target="_blank" rel="external">状态栏数字键+大写键状态</a></h2><p><img src="http://public-links.qiniudn.com/gnome-shell-lock-keys.png" alt=""></p>
<h2 id="番茄工作法插件"><a href="#番茄工作法插件" class="headerlink" title="番茄工作法插件"></a><a href="https://extensions.gnome.org/extension/53/pomodoro/" target="_blank" rel="external">番茄工作法插件</a></h2><p><img src="http://public-links.qiniudn.com/gnome-shell-pomodoro.png" alt=""></p>
<h2 id="系统托盘"><a href="#系统托盘" class="headerlink" title="系统托盘"></a><a href="https://extensions.gnome.org/extension/495/topicons/" target="_blank" rel="external">系统托盘</a></h2><p><img src="http://public-links.qiniudn.com/gnome-shell-topicons.png" alt=""></p>
<h2 id="状态栏网速"><a href="#状态栏网速" class="headerlink" title="状态栏网速"></a><a href="https://extensions.gnome.org/extension/104/netspeed/" target="_blank" rel="external">状态栏网速</a></h2><p><img src="http://public-links.qiniudn.com/gnome-shell-netspeed.png" alt=""></p>
<h2 id="状态栏日历"><a href="#状态栏日历" class="headerlink" title="状态栏日历"></a><a href="https://extensions.gnome.org/extension/163/analog-clock/" target="_blank" rel="external">状态栏日历</a></h2><p><img src="http://public-links.qiniudn.com/gnome-shell-alternatetab.png" alt=""></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/linux/">linux</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gnome/">gnome</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-spring/SpringXD HA 配置" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/spring/SpringXD HA 配置/" class="article-date">
      <time datetime="2016-06-29T08:34:48.000Z" itemprop="datePublished">2016-06-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/spring/SpringXD HA 配置/">SpringXD HA 配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><a href="http://docs.spring.io/spring-xd/docs/1.3.1.RELEASE/reference/html" target="_blank" rel="external">SpringXD官方文档</a> 上说的不是很清楚，而且有些配置（如 配置 <code>hadoop</code> namenode ha ）并没有在上面说明，只是简单的说明了怎么配置 <code>namenode</code> ，如果没有ha配置，那么在生产环境中会令人头痛。</p>
<h1 id="XD-Admin-HA"><a href="#XD-Admin-HA" class="headerlink" title="XD Admin HA"></a>XD Admin HA</h1><h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p>在 <a href="http://docs.spring.io/spring-xd/docs/1.3.1.RELEASE/reference/html/#_configuring_spring_xd_for_high_availabilty_ha" target="_blank" rel="external">官方文档</a> 中，有说如何配置，就是通过启动多个<code>admin</code> ，然后通过 <code>zookeeper</code> 管理。<br><code>Spring XD</code> 要求只有一个主节点来和 <code>Container</code> 交互，例如 <code>Stream</code> 发布等。同时，这些操作都是按顺序处理的。假如只有一个 <code>admin</code> ，那么就存在单点失败的风险，因此，在生产环境中推荐做法是启动 2 个或者多 <code>admin</code> 。注意：在有多个 <code>admin</code> 节点的时候，每个 <code>admin</code> 都可以处理 <a href="http://docs.spring.io/spring-xd/docs/1.3.1.RELEASE/reference/html/#REST-API" target="_blank" rel="external">REST</a> 请求，但是只有一个实例会作为 <code>Leader</code> 处理请求并更新运行时的状态。如果 <code>Leader</code> 宕掉，另一个可用的admin就会成为新的 <code>Leader</code> 来接管任务。当然，Spring XD 的HA不只是他自身要求ha，还需要依赖外部服务，如：<code>zookeeper</code>，<code>MessageBus</code> 等 HA 配置。</p>
<h2 id="配置信息"><a href="#配置信息" class="headerlink" title="配置信息"></a>配置信息</h2><p>如果要配置 <code>admin</code> 的 ha，那么启动多个 <code>admin</code> 即可，但是请注意，如果是在同一台机器上部署多个<code>admin</code>，需要在启动时候添加如下参数以防止和默认的端口（<code>9393</code>）冲突：<br><code>--httpPort</code> 用来指定rest api端口<br><code>--mgmtPort</code> 用来指定管理端口<br>如果在不同机器上启动，只需配置相同的配置文件，然后启动即可。</p>
<h1 id="XD-Container-HA"><a href="#XD-Container-HA" class="headerlink" title="XD Container HA"></a>XD Container HA</h1><p>当添加 <code>Container</code> 的时候，Spring XD 可以动态水平扩展，也就是说不需要额外什么操作，只需像第一次启动 <code>Container</code> 一样输入命令 <code>bin/xd-container</code> 启动即可。</p>
<h1 id="XD-Hadoop-namenode-HA"><a href="#XD-Hadoop-namenode-HA" class="headerlink" title="XD Hadoop namenode HA"></a>XD Hadoop namenode HA</h1><p>如果 xd 中创建 <code>stream</code> 或者其他任务是用到了 <code>hdfs</code> 的功能，那么要配置 <code>hadoop</code> 的<code>namenode</code> ，要在 <code>xd/config/servers.xml</code>中的 <code>spring.hadoop.fsUri</code> 的配置项中配置。注意，这个地方只允许配置一个 <code>host</code>，如果有备用 <code>namenode</code> ，是不允许配置在这个地方的。但是这样配置是有问题的，就是存在 <code>hadoop</code> 的 <code>namenode</code> 主从切换后 xd 的 <code>stream</code> 无法写入 <code>hdfs</code> 或者读取 <code>hdfs</code> 的故障。要解决这个问题，我们要再 <code>xd/config/hadoop.properties</code> 中配置如下配置项：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">dfs.nameservices=MyCluster</div><div class="line">dfs.ha.namenodes.MyCluster=nn1,nn2</div><div class="line">dfs.namenode.rpc-address.MyCluster.nn2=hadoop-master1-host:8020</div><div class="line">dfs.namenode.rpc-address.MyCluster.nn1=hadoop-master2-host:8020</div><div class="line">dfs.client.failover.proxy.provider.MyCluster=org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider</div></pre></td></tr></table></figure></p>
<p>其中，配置项中所有的 <code>MyCluster</code> 要换成自己项目中 hadoop 集群的名字，然后在 <code>xd/config/servers.xml</code> 中 <code>spring.hadoop.fsUri</code> 值配置成 <code>hdfs://MyCluster:8020</code>（注意<code>8020</code>端口换成自己配置的），<code>hadoop-master1-host</code> 和 <code>hadoop-master1-host</code> 换成自己集群的 hadoop的 master 的主机名字或者ip。这样配置后，重新启动 <code>admin</code> 和 <code>container</code> 就会自动检测 hadoop 的 <code>namenode</code> 主从，并自行切换。<br>如果要在 <code>xd-shell</code>中使用，需要登录shell之后（如果有安全设置，还需要先用密码登录成功），输入一下命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">hadoop config props set --property dfs.nameservices=MyCluster</div><div class="line">hadoop config props set --property dfs.ha.namenodes.MyCluster=nn1,nn2</div><div class="line">hadoop config props set --property dfs.namenode.rpc-address.MyCluster.nn1=hadoop-master1-host:8020</div><div class="line">hadoop config props set --property dfs.namenode.rpc-address.MyCluster.nn2=hadoop-master2-host:8020</div><div class="line">hadoop config props set --property dfs.client.failover.proxy.provider.MyCluster=org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider</div><div class="line">hadoop config fs --namenode hdfs://MyCluster</div></pre></td></tr></table></figure></p>
<p><code>MyCluster</code>，<code>hadoop-master1-host</code> 和 <code>hadoop-master2-host</code> 同上配置。对于 shell 来说，单纯配置 hadoop 的主 <code>namenode</code>也是可以的，因为这个配置只是对 shell 起作用。如果觉得每次打开shell都要输入上面几行配置太繁琐的话，可以将 <code>xd/config/hadoop.properties</code> 中配置的项目添加一份到<code>shell/config/hadoop.properties</code> 即可，这样在shell中操作hdfs，只需配置 <code>hadoop config fs --namenode hdfs://MyCluster:8020</code> 即可。</p>
<h2 id="附言"><a href="#附言" class="headerlink" title="附言"></a>附言</h2><p>对于如何在xd中使用hadoop的namenode ha配置，xd 官方文档中并未见说明，而是百般Goole之后得到的结果，而且由于xd资料尚少，搜索结果不佳，最后通过搜索关键词 <code>xd namenode fail</code> 才找到解决方案，<a href="https://jira.spring.io/browse/XD-1745" target="_blank" rel="external">请参见这里</a>。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/spring/">spring</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/">spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xd/">xd</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-spark/sbt源配置" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/spark/sbt源配置/" class="article-date">
      <time datetime="2016-06-20T03:21:13.000Z" itemprop="datePublished">2016-06-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/spark/sbt源配置/">sbt源配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="sbt-默认源下载有点慢，我们可以调教它，让它从我们自己配置的源下载。"><a href="#sbt-默认源下载有点慢，我们可以调教它，让它从我们自己配置的源下载。" class="headerlink" title="sbt 默认源下载有点慢，我们可以调教它，让它从我们自己配置的源下载。"></a>sbt 默认源下载有点慢，我们可以调教它，让它从我们自己配置的源下载。</h1><h2 id="配置源"><a href="#配置源" class="headerlink" title="配置源"></a>配置源</h2><p>在 <code>.sbt</code> （默认是在用户名下）文件夹中创建 <code>repositories</code> 文件，然后添加如下内容:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">[repositories]</div><div class="line">  local</div><div class="line">  my: http://o8r69qphn.bkt.clouddn.com/</div><div class="line">  Nexus osc: http://maven.oschina.net/content/groups/public/</div><div class="line">  Nexus osc thirdparty: http://maven.oschina.net/content/repositories/thirdparty/</div><div class="line">  central: http://central.maven.org/maven2/</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">[ivy]</div><div class="line">  local</div><div class="line">  my: http://o8r69qphn.bkt.clouddn.com/</div><div class="line">  Nexus osc: http://maven.oschina.net/content/groups/public/</div><div class="line">  Nexus osc thirdparty: http://maven.oschina.net/content/repositories/thirdparty/</div><div class="line">  central: http://central.maven.org/maven2/</div><div class="line">  TypeSafe: https://oss.sonatype.org/content/repositories/releases/</div><div class="line">  #proxy库</div><div class="line">  typesafe-ivy-releases: http://dl.bintray.com/typesafe/ivy-releases/</div><div class="line">  typesafe-maven-releases: http://dl.bintray.com/typesafe/maven-releases/</div><div class="line">  typesafe-sbt-plugin-releases: http://dl.bintray.com/sbt/sbt-plugin-releases/</div><div class="line"></div><div class="line">  #group库</div><div class="line">  ivy-releases : typesafe-ivy-releases,typesafe-sbt-plugin-releases</div></pre></td></tr></table></figure></p>
<p>上面 <code>repositories</code> 是说加载maven镜像中的库文件从这个标签下的路径中找， <code>local</code> 代表从本地中找，默认是 <code>.M2</code> 中，下面的都是自定义源，名字随便取。<br>下面 <code>ivy</code> 是加载ivy库的。</p>
<h2 id="修改加载配置项"><a href="#修改加载配置项" class="headerlink" title="修改加载配置项"></a>修改加载配置项</h2><p>单纯修改上面的源还不足以让sbt加载我们的源。打开 sbt 软件安装位置下的 <code>conf/sbtopts</code> 文件，在其中添加：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">-Dsbt.override.build.repos=true</div></pre></td></tr></table></figure></p>
<p>然后就可以生效了。</p>
<p><strong> 没有深入研究，如果有错还请指出 </strong></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/spark/">spark</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sbt/">sbt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scala/">scala</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="linux-linux/Linux-Shell-命令" class="article article-type-linux" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/linux/Linux-Shell-命令/" class="article-date">
      <time datetime="2016-05-25T01:34:07.000Z" itemprop="datePublished">2016-05-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/linux/Linux-Shell-命令/">Linux shell 命令</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="lsof"><a href="#lsof" class="headerlink" title="lsof"></a>lsof</h2><p>适用于ip4</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lsof -Pnl +M -i4 | grep port</div></pre></td></tr></table></figure>
<p>适用于ip6</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lsof -Pnl +M -i6 | grep port</div></pre></td></tr></table></figure>
<h2 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h2><p>杀掉名字一样的java进程<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">jps |grep SparkSubmit | awk &apos;&#123;print &quot;kill -9 &quot; $1&#125;&apos; | sh</div></pre></td></tr></table></figure></p>
<p>如果仅仅是打印命令，则后面的管道和sh不需要加，如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">jps |grep SparkSubmit | awk &apos;&#123;print &quot;kill -9 &quot; $1&#125;&apos;</div></pre></td></tr></table></figure></p>
<h2 id="find"><a href="#find" class="headerlink" title="find"></a>find</h2><p>删除找到的符合条件的文件（或者目录）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">find . -iname target -exec rm -rf &#123;&#125; \;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/linux/">linux</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/">shell</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-spark/sbt-idea-入门及配置" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/spark/sbt-idea-入门及配置/" class="article-date">
      <time datetime="2016-05-10T01:35:48.000Z" itemprop="datePublished">2016-05-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/spark/sbt-idea-入门及配置/">sbt-idea-入门及配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="Java-环境配置"><a href="#Java-环境配置" class="headerlink" title="Java 环境配置"></a>Java 环境配置</h1><p>这个就不多说了，这是前提条件，请自行安装后配置正确，如果不清楚请自行搜索 <strong>java 环境变量配置</strong> 相关问题。</p>
<h1 id="Scala-配置"><a href="#Scala-配置" class="headerlink" title="Scala 配置"></a>Scala 配置</h1><p>首先要要配置 scala 环境。从<a href="http://scala-lang.org/" target="_blank" rel="external">官方</a>地址下载，这里我们使用scala2.10.6版本，所以<a href="http://scala-lang.org/download/2.10.6.html" target="_blank" rel="external">从这里下载</a>对应的平台版本。Windows请下载 <a href="http://downloads.lightbend.com/scala/2.10.6/scala-2.10.6.zip" target="_blank" rel="external">scala-2.10.6.zip</a> ，MacOS和Linux请下载 <a href="http://downloads.lightbend.com/scala/2.10.6/scala-2.10.6.tgz" target="_blank" rel="external">scala-2.10.6.tgz</a> 。</p>
<p>下载完成后，解压到一个目录，然后配置环境变量 <code>SCALA_HOME</code> ，把scala的解压后的绝对路径配置到 <code>SCALA_HOME</code> ，然后增加 <code>PATH</code> 的配置。以下以 WIndows 和 Linux 举例来说，假如这里解压后得到的文件夹为 <code>scala-2.10.6</code>。</p>
<h2 id="Windows-环境"><a href="#Windows-环境" class="headerlink" title="Windows 环境"></a>Windows 环境</h2><p>假如 <code>scala-2.10.6</code> 文件夹放在了 <code>C:\</code>目录下，那么新增 <code>SCALA_HOME</code> 的值为 <code>C:\scala-2.10.6</code> ，然后找到 <code>PATH</code> 这个环境变量， 在已有的值后面添加 <code>;%SCALA_HOME%\bin</code> （注意前面的分号），重新打开一个新的命令行窗口即可操作。关于windows环境变量的其他说明情自行补脑，这里就不多啰嗦了。</p>
<h2 id="Linux-和-Mac-环境"><a href="#Linux-和-Mac-环境" class="headerlink" title="Linux 和 Mac 环境"></a>Linux 和 Mac 环境</h2><p>这里假定我们 <code>scala-2.10.6</code> 的 scala 目录存放在 <code>/usr/local/</code> 下，绝对路径就是 <code>/usr/local/scala-2.10.6</code> 。</p>
<h3 id="Bash-环境"><a href="#Bash-环境" class="headerlink" title="Bash 环境"></a>Bash 环境</h3><p>bash 环境下可以修改 <code>~/.bashrc</code> 或者 <code>/etc/profile</code> 文件，添加一下内容：             </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">SCALA_HOME=/usr/<span class="built_in">local</span>/scala-2.10.6</div><div class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$SCALA_HOME</span>/bin</div><div class="line"></div><div class="line"><span class="built_in">export</span> SCALA_HOME PATH</div></pre></td></tr></table></figure>
<p>然后执行 <code>source ~/.bashrc</code> 或者 <code>source /etc/profile</code> 即可。</p>
<h3 id="Zsh-环境"><a href="#Zsh-环境" class="headerlink" title="Zsh 环境"></a>Zsh 环境</h3><p>如果你的终端bash用的是 zsh ，那么需要在 <code>~/.zshrc</code> 文件中增加上述内容，然后执行 <code>source ~/.zshrc</code> 即可。</p>
<h1 id="Sbt-配置"><a href="#Sbt-配置" class="headerlink" title="Sbt 配置"></a>Sbt 配置</h1><p><a href="http://www.scala-sbt.org/" target="_blank" rel="external">官方地址</a>，<a href="http://www.scala-sbt.org/download.html" target="_blank" rel="external">从这里下载</a>，如果是MacOS的话，可以依照这里提示的方法进行快捷安装，如果是其他平台或者想手动配置，<a href="https://dl.bintray.com/sbt/native-packages/sbt/0.13.11/sbt-0.13.11.zip" target="_blank" rel="external">点击这里直接下载</a>即可。</p>
<p>下载完成并解压，得到文件夹 <code>sbt</code>。</p>
<h2 id="Windows-环境-1"><a href="#Windows-环境-1" class="headerlink" title="Windows 环境"></a>Windows 环境</h2><p>假如我们将 <code>sbt</code> 文件夹放到了 <code>C:\</code>目录下。新增环境变量 <code>SBT_HOME</code> 值为 <code>C:\sbt</code>， 在 <code>PATH</code> 变量值后面添加 <code>;%SBT_HOME%\bin</code>，重新打开一个新的命令行窗口即可。</p>
<h2 id="Linux-或者-Mac-环境"><a href="#Linux-或者-Mac-环境" class="headerlink" title="Linux 或者 Mac 环境"></a>Linux 或者 Mac 环境</h2><p>这里假定我们将 <code>sbt</code> 目录放在了 <code>/usr/local/</code> 目录下。同上面配置 scala 环境变量一样。</p>
<h3 id="Bash-环境-1"><a href="#Bash-环境-1" class="headerlink" title="Bash 环境"></a>Bash 环境</h3><p>编辑 <code>~/.bashrc</code> 或者 <code>/etc/profile</code> ，新增以下内容:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">SBT_HOME=/usr/<span class="built_in">local</span>/sbt</div><div class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$SBT_HOEM</span>/bin</div><div class="line"></div><div class="line"><span class="built_in">export</span> SBT_HOME PATH</div></pre></td></tr></table></figure>
<p>然后执行 <code>source ~/.bashrc</code> 或者 <code>source /etc/profile</code> 即可生效。</p>
<h3 id="Zsh-环境-1"><a href="#Zsh-环境-1" class="headerlink" title="Zsh 环境"></a>Zsh 环境</h3><p>编辑 <code>~/.zshrc</code>， 添加上面的内容并保存后，执行 <code>source ~/.zshrc</code> 即可生效。</p>
<h2 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h2><h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p>在随意一个地方创建一个文件夹，名字为 <code>spark-sbt-demo</code> ，下面是目录结构：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">spark-sbt-demo                                                                                                                                                                         </div><div class="line">├── build.sbt</div><div class="line">├── project</div><div class="line">│   ├── build.properties</div><div class="line">│   └── plugins.sbt</div><div class="line">└── src</div><div class="line">    ├── main</div><div class="line">        ├── scala</div><div class="line">           └── WordCount.scala</div></pre></td></tr></table></figure>
<p>build.sbt 文件中添加如下内容（注意每行要用空行隔开）：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">name := <span class="string">"spark-sbt-demo"</span></div><div class="line"></div><div class="line">version := <span class="string">"1.0"</span></div><div class="line"></div><div class="line">scalaVersion := <span class="string">"2.10.6"</span></div><div class="line"></div><div class="line">organization := <span class="string">"spark.demo"</span></div><div class="line"></div><div class="line">version := <span class="string">"1.0.0-SNAPSHOT"</span></div><div class="line"></div><div class="line">libraryDependencies += <span class="string">"org.apache.spark"</span> % <span class="string">"spark-core_2.10"</span> % <span class="string">"1.6.1"</span> % <span class="string">"provided"</span></div></pre></td></tr></table></figure>
<p>WordCount.scala 文件内容：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">  * Created by sdvdxl on 16/5/11.</div><div class="line">  */</div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">WordCount</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]) &#123;</div><div class="line">    <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setAppName(<span class="string">"spark-sbt-demo"</span>).setMaster(<span class="string">"local[*]"</span>)</div><div class="line">    <span class="keyword">val</span> sc  = <span class="keyword">new</span> <span class="type">SparkContext</span>(conf)</div><div class="line">    sc.textFile(<span class="string">"src/main/scala/WordCount.scala"</span>).flatMap(_.split(<span class="string">" "</span>)).map(word=&gt;(word,<span class="number">1</span>)).reduceByKey(_+_).foreach(println)</div><div class="line">    sc.stop()</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>build.properties 文件内容 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sbt.version = 0.13.11</div></pre></td></tr></table></figure>
<p>plugins.sbt 文件先保持为空。</p>
<p>至此，我们已经创建了一个 sbt 机构的项目。</p>
<p>接下来会说明使用sbt下载依赖，使用 idea 创建 sbt 项目，在idea中如何运行sbt管理的 spark app。</p>
<h2 id="Sbt-的基本使用"><a href="#Sbt-的基本使用" class="headerlink" title="Sbt 的基本使用"></a>Sbt 的基本使用</h2><p>上面我们创建了一个用 sbt 管理的 spark app 项目，如果想要提交到spark中运行，那么需要打包成jar包，好在 sbt 本身或者插件提供了这样的功能。</p>
<h3 id="应用打包"><a href="#应用打包" class="headerlink" title="应用打包"></a>应用打包</h3><p>打开命令行，切换到该项目目录下，然后输入 <code>sbt</code> 之后，进入 sbt 的交互中，然后输入 <code>package</code> ，开始打包，最后如果看到类似</p>
<blockquote>
<p>[info] Done packaging.<br>  [success] Total time: 11 s, completed 2016-5-11 12:32:09</p>
</blockquote>
<p>字样，那么说明打包成功，打成的 jar 包在上面的日志中可以找到。</p>
<h3 id="第三方-jar-统一打包"><a href="#第三方-jar-统一打包" class="headerlink" title="第三方 jar 统一打包"></a>第三方 jar 统一打包</h3><p>在写应用的时候，我们不只是用到 <code>spark</code> 自身的 jar 包，还会用到好多其他第三方类库，那么，在提交应用到 spark 运行的时候，这些第三方依赖也需要一并提交上去，否则会出现找不到类的问题。如果依赖少的话，直接将这些 jar 包直接一个一个提交上去也没问题，但是一旦依赖了大量的类库，这种方法显然是低效费力的，那么怎么才能将这些所有的第三方依赖打成一个 jar 包呢？</p>
<p>sbt 本身没有提供这样的功能，但是我们可以依靠相应的插件完成此操作。记得上面有个文件内容留空的 <code>plugins.sbt</code> 文件吗？这个文件中可以配置我们想要完成特定功能的插件，现在我们在其中添加如下内容：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">addSbtPlugin(<span class="string">"com.eed3si9n"</span> % <span class="string">"sbt-assembly"</span> % <span class="string">"0.14.2"</span>)</div></pre></td></tr></table></figure>
<p>然后重新 进入 sbt 交互式环境，输入 <code>assemblyPackageDependency</code> 回车，稍后将看到类似如下输出：    </p>
<blockquote>
<p>[info] Done packaging.<br>  [success] Total time: 41 s, completed 2016-5-11 13:36:37</p>
</blockquote>
<p>这样就成功的将所有依赖的第三方类库打包到一个 jar 包中了，具体打包的文件可以在上面的日志中看到。</p>
<h2 id="使用-idea-创建-sbt-项目"><a href="#使用-idea-创建-sbt-项目" class="headerlink" title="使用 idea 创建 sbt 项目"></a>使用 idea 创建 sbt 项目</h2><h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><p>使用 idea 创建 sbt 项目需要安装 <code>scala</code> 和 <code>sbt</code> 插件。<br>打开idea的首选项，然后找到 <code>Plugins</code> ，点击 <code>Browser repositores...</code> 按钮，输入 <code>scala</code> 搜索，然后找到 <code>scala</code> 和 <code>sbt</code> 的插件进行安装，如下图所示：<br><img src="/images/scala/scala-sbt-plugin.png" alt="scala-sbt-plugins"><br>安装完成后重启idea。</p>
<h3 id="创建-sbt-项目"><a href="#创建-sbt-项目" class="headerlink" title="创建 sbt 项目"></a>创建 sbt 项目</h3><p>File -&gt; New -&gt; Project… 打开项目创建向导：<br><img src="/images/scala/sbt-project-1.png" alt="创建sbt项目"><br>创建完成后，等待idea刷新项目，目录结构大体如下（project/project 和 target相关没有列出）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">spark-sbt-demo                                                                                                                                                                </div><div class="line">├── build.sbt</div><div class="line">├── project</div><div class="line">│   ├── build.properties</div><div class="line">│   └── plugins.sbt</div><div class="line">└── src</div><div class="line">    ├── main</div><div class="line">    │   ├── java</div><div class="line">    │   ├── resources</div><div class="line">    │   ├── scala</div><div class="line">    │   └── scala-2.11</div><div class="line">    └── test</div><div class="line">        ├── java</div><div class="line">        ├── resources</div><div class="line">        ├── scala</div><div class="line">        └── scala-2.11</div></pre></td></tr></table></figure>
<ul>
<li><code>plugins.sbt</code> 文件放置插件配置</li>
<li><code>build.sbt</code> 是整体的项目配置信息</li>
<li><code>build.properties</code> 可以设置 sbt 版本</li>
<li><code>java</code> 目录存放 java 文件</li>
<li><code>scala</code> 目录存放 scala 文件</li>
<li><code>resources</code> 目录用来存放配置文件</li>
<li><code>test</code> 相关目录用来存放测试相关文件<h2 id="在-idea-中-运行-spark-app"><a href="#在-idea-中-运行-spark-app" class="headerlink" title="在 idea 中 运行 spark app"></a>在 idea 中 运行 spark app</h2>上面我们介绍了如何使用 idea 项目向导创建一个 sbt 项目，现在我们来说一下如何在 idea 中直接运行 sbt 构建的 spark app。</li>
</ul>
<p>这里我们使用一开始我们创建的那个项目，使用 idea 导入功能，File -&gt; Open 找到项目目录打开即可。<br>在 <code>WordCount.scala</code> 文件中右键，选择 <code>Run WordCount</code> ，开始运行，但是结果可能不是我们所期望的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">Exception in thread <span class="string">"main"</span> java.lang.NoClassDefFoundError: org/apache/spark/SparkConf</div><div class="line">	at WorldCount$.main(WorldCount.scala:<span class="number">8</span>)</div><div class="line">	at WorldCount.main(WorldCount.scala)</div><div class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</div><div class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:<span class="number">62</span>)</div><div class="line">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class="number">43</span>)</div><div class="line">	at java.lang.reflect.Method.invoke(Method.java:<span class="number">497</span>)</div><div class="line">	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:<span class="number">144</span>)</div><div class="line">Caused by: java.lang.ClassNotFoundException: org.apache.spark.SparkConf</div><div class="line">	at java.net.URLClassLoader.findClass(URLClassLoader.java:<span class="number">381</span>)</div><div class="line">	at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="number">424</span>)</div><div class="line">	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:<span class="number">331</span>)</div><div class="line">	at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="number">357</span>)</div><div class="line">	... <span class="number">7</span> more</div><div class="line"></div><div class="line">Process finished with exit code <span class="number">1</span></div></pre></td></tr></table></figure>
<p>这是为什么呢？原因是我们在 <code>build.sbt</code> 中配置的 spark 依赖是这样的：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">libraryDependencies += <span class="string">"org.apache.spark"</span> % <span class="string">"spark-core_2.10"</span> % <span class="string">"1.6.1"</span> % <span class="string">"provided"</span></div></pre></td></tr></table></figure>
<p>注意到后面的 <code>provided</code> 了吗？这个代表打包或者运行的时候不会将这个 jar 包的文件包含进去（注意：spark app 要求这样，注意不要把spark相关的jar包包含进去）。这样导致我们无法再 idea 中调试或者运行 spark app。</p>
<p>解决方案还是有的，sbt 和 maven（也是一个项目管理的软件）一样，提供了模块开发功能，我们定义两个模块，一个模块就是我们上面我们做好的，另一个是用来运行的，这个里面包含了运行时类库，配置如下：</p>
<ol>
<li>创建一个名为 <code>main</code> 的文件夹，把项目中的 <code>src</code> 文件夹移动到这个目录下</li>
<li>在项目根目录下创建名为 <code>run</code> 的文件夹</li>
<li><p>修改项目根目录下的 <code>build.sbt</code> 文件，内容为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">name := &quot;spark-sbt-demo&quot;</div><div class="line"></div><div class="line">version := &quot;1.0&quot;</div><div class="line"></div><div class="line">scalaVersion := &quot;2.10.4&quot;</div><div class="line"></div><div class="line">organization := &quot;spark.demo&quot;</div><div class="line"></div><div class="line">version := &quot;1.0.0-SNAPSHOT&quot;</div><div class="line"></div><div class="line">libraryDependencies += &quot;org.apache.spark&quot; % &quot;spark-core_2.10&quot; % &quot;1.6.1&quot; % &quot;provided&quot;</div><div class="line"></div><div class="line">lazy val root = (project in file(&quot;.&quot;)).aggregate(main, run)</div><div class="line"></div><div class="line">lazy val main = (project in file(&quot;main&quot;))</div><div class="line"></div><div class="line">lazy val run = (project in file(&quot;run&quot;)).dependsOn(main)</div></pre></td></tr></table></figure>
</li>
<li><p>在子项目 <code>main</code> 创建 <code>build.sbt</code> 内容为：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">libraryDependencies += <span class="string">"org.apache.spark"</span> % <span class="string">"spark-core_2.10"</span> % <span class="string">"1.6.1"</span> % <span class="string">"provided"</span></div></pre></td></tr></table></figure>
</li>
<li><p>在子项目 <code>run</code> 创建 <code>build.sbt</code> 内容为 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">libraryDependencies += &quot;org.apache.spark&quot; % &quot;spark-core_2.10&quot; % &quot;1.6.1&quot;</div></pre></td></tr></table></figure>
</li>
<li><p>配置运行参数，如下图：<br><img src="/images/scala/idea-spark-run-config.png" alt="idea-spark-run-config"><br>然后选择上面的运行配置，运行即可。这里可能会碰到一个异常：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Exception in thread <span class="string">"main"</span> org.apache.hadoop.mapred.InvalidInputException: Input path does not exist: file:/Users/du/workspace/hekr/spark-sbt-demo/src/main/scala/WorldCount.scala</div><div class="line">	at org.apache.hadoop.mapred.FileInputFormat.listStatus(FileInputFormat.java:<span class="number">251</span>)</div><div class="line">	at org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:<span class="number">270</span>)</div><div class="line">	......</div></pre></td></tr></table></figure>
</li>
</ol>
<p>这是由于上面我们修改了改程序main文件的位置，导致找不到该文件所致，请自行设置为一个存在的文件路径或者修改为 <code>main/src/main/scala/WorldCount.scala</code> 重新运行即可成功。</p>
<h2 id="Sbt-本地依赖库存储位置配置"><a href="#Sbt-本地依赖库存储位置配置" class="headerlink" title="Sbt 本地依赖库存储位置配置"></a>Sbt 本地依赖库存储位置配置</h2><p>抽空再补上，其实就是建立一个连接，先自行思考方案。</p>
<h1 id="项目下载"><a href="#项目下载" class="headerlink" title="项目下载"></a>项目下载</h1><p>没有源码下载的都是耍流氓，<a href="/files/spark-sbt-demo.tar.gz">点这里下载</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/spark/">spark</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scala/">scala</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spark/">spark</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-java/JDK多版本管理" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/java/JDK多版本管理/" class="article-date">
      <time datetime="2016-04-20T01:43:43.000Z" itemprop="datePublished">2016-04-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/java/JDK多版本管理/">JDK多版本管理</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在实际工作环境中经常碰到不同项目要用不同jdk版本问题，比如我的项目组现在用的是jdk8，而用spark打包的应用是用的jdk7，所以有必要记录一下版本配置和切换问题。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/java/">java</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jdk/">jdk</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-spring/通过SpringXD将信息分片-文件夹存储到HDFS" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/spring/通过SpringXD将信息分片-文件夹存储到HDFS/" class="article-date">
      <time datetime="2016-03-16T09:29:03.000Z" itemprop="datePublished">2016-03-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/spring/通过SpringXD将信息分片-文件夹存储到HDFS/">通过SpringXD将信息分片|文件夹存储到HDFS</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <pre><code>kafka --topic=kafka_test --zkconnect=10.10.1.20:2181 --queueSize=64 |hdfs --inputType=application/json --idleTimeout=10000 --partitionPath=dateFormat(&apos;yyyy/MM/dd/HH/mm&apos;)
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/spring/">spring</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hdfs/">hdfs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/">kafka</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring-xd/">spring xd</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2017 杜龙少
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >访客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="//cdn.bootcss.com/require.js/2.1.6/require.min.js"></script>
<script src="//cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>


<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>