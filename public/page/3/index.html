<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>杜龙少的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="杜龙少的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="杜龙少的博客">
<meta property="og:url" content="http://todu.top/page/3/index.html">
<meta property="og:site_name" content="杜龙少的博客">
<meta property="og:description" content="杜龙少的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="杜龙少的博客">
<meta name="twitter:description" content="杜龙少的博客">
  
    <link rel="alternative" href="/atom.xml" title="杜龙少的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favorite.ico">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="me.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">杜龙少</a></h1>
        </hgroup>

        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">博客首页</a></li>
                        
                            <li><a href="/tags">分类|标签</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github" target="_blank" href="https://github.com/sdvdxl" title="github">github</a>
                            
                                <a class="fl linkedin" target="_blank" href="http://www.linkedin.com/in/sdvdxl" title="linkedin">linkedin</a>
                            
                                <a class="fl weibo" target="_blank" href="http://weibo.com/lishangmou" title="weibo">weibo</a>
                            
                                <a class="fl twitter" target="_blank" href="https://twitter.com/sdvdxl" title="twitter">twitter</a>
                            
                                <a class="fl facebook" target="_blank" href="https://www.facebook.com/sdvdxl" title="facebook">facebook</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/arch/" style="font-size: 11.43px;">arch</a> <a href="/tags/archlinux/" style="font-size: 11.43px;">archlinux</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/go/" style="font-size: 18.57px;">go</a> <a href="/tags/golang/" style="font-size: 20px;">golang</a> <a href="/tags/hadoop/" style="font-size: 14.29px;">hadoop</a> <a href="/tags/hdfs/" style="font-size: 17.14px;">hdfs</a> <a href="/tags/hive/" style="font-size: 10px;">hive</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/jdk/" style="font-size: 10px;">jdk</a> <a href="/tags/jrebel/" style="font-size: 10px;">jrebel</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/linux/" style="font-size: 14.29px;">linux</a> <a href="/tags/mysql/" style="font-size: 12.86px;">mysql</a> <a href="/tags/ntfs/" style="font-size: 10px;">ntfs</a> <a href="/tags/sbt/" style="font-size: 10px;">sbt</a> <a href="/tags/scala/" style="font-size: 11.43px;">scala</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/spark/" style="font-size: 15.71px;">spark</a> <a href="/tags/spark-streaming/" style="font-size: 11.43px;">spark-streaming</a> <a href="/tags/spring/" style="font-size: 14.29px;">spring</a> <a href="/tags/spring-xd/" style="font-size: 17.14px;">spring xd</a> <a href="/tags/spring-xd/" style="font-size: 12.86px;">spring-xd</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/sqoop/" style="font-size: 11.43px;">sqoop</a> <a href="/tags/windows8/" style="font-size: 10px;">windows8</a> <a href="/tags/xd/" style="font-size: 12.86px;">xd</a> <a href="/tags/zookeeper/" style="font-size: 11.43px;">zookeeper</a> <a href="/tags/博客/" style="font-size: 10px;">博客</a> <a href="/tags/安卓/" style="font-size: 10px;">安卓</a> <a href="/tags/录音/" style="font-size: 10px;">录音</a> <a href="/tags/端口/" style="font-size: 10px;">端口</a> <a href="/tags/软件/" style="font-size: 10px;">软件</a> <a href="/tags/进程/" style="font-size: 10px;">进程</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://MOxFIVE.github.io/">MOxFIVE</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.vsay.cn/">DoubleV</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.ccwebsite.com/">兮兮</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.dandyweng.com/">翁天信</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.plqblog.com/views/index.php">潘利强</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.hankin.cn/">hankin</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.waydrow.com/">waydrow</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">喜欢接触新鲜事物、迎接新的挑战</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">杜龙少</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="me.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">杜龙少</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">博客首页</a></li>
                
                    <li><a href="/tags">分类|标签</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/sdvdxl" title="github">github</a>
                    
                        <a class="linkedin" target="_blank" href="http://www.linkedin.com/in/sdvdxl" title="linkedin">linkedin</a>
                    
                        <a class="weibo" target="_blank" href="http://weibo.com/lishangmou" title="weibo">weibo</a>
                    
                        <a class="twitter" target="_blank" href="https://twitter.com/sdvdxl" title="twitter">twitter</a>
                    
                        <a class="facebook" target="_blank" href="https://www.facebook.com/sdvdxl" title="facebook">facebook</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-git/删除git已经跟踪的文件或者目录" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/git/删除git已经跟踪的文件或者目录/" class="article-date">
      <time datetime="2016-03-13T03:09:29.000Z" itemprop="datePublished">2016-03-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/git/删除git已经跟踪的文件或者目录/">删除git已经跟踪的文件或者目录</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>如果第一次提交的时候，没有在gitignore文件中添加忽略文件，那么这些文件（目录也是文件）就会被git跟踪，push的时候也会被推送到远程。所以最好就是一开始在commit之前先添加到gitignore中。</p>
<p>如果文件已经被跟踪且被推送到远程，可以按照下面方法解决：<br>1.<code>rm -rf 文件</code></p>
<ol>
<li><code>git rm -r --cached 要忽略的文件</code><br>3.<code>git add -A (添加所有)</code><br>4.<code>git push origin 分支</code></li>
</ol>
<p>如果同名的文件过多，如：.class 文件被提交了，那么如果这样一个一个显然效率太低，可以按照下面方法操作</p>
<ol>
<li><code>find . -iname 文件名 -exec rm -rf {}\;</code></li>
<li>重复上面的步骤，文件名替换为下一个要删除的文件名</li>
<li>修改gitignore，添加忽略文件</li>
<li><code>git rm -r --cached 要忽略的文件</code></li>
<li><code>git add -A</code></li>
<li><code>git push origin 分支</code></li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/git/">git</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-hadoop/hadoop集成hive" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/hadoop/hadoop集成hive/" class="article-date">
      <time datetime="2016-03-11T08:25:27.000Z" itemprop="datePublished">2016-03-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/hadoop/hadoop集成hive/">hadoop集成hive</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="前置条件"><a href="#前置条件" class="headerlink" title="前置条件"></a>前置条件</h1><p>hadoop和yarn已经配置好并且成功运行。</p>
<h1 id="选择版本和下载"><a href="#选择版本和下载" class="headerlink" title="选择版本和下载"></a>选择版本和下载</h1><p><a href="http://www.apache.org/dyn/closer.cgi/hive/" target="_blank" rel="external">下载hive</a>，有两个版本可以选择，hive1和hive2，hive2版本MR功能已经废弃，将来版本可能会直接去掉，如果要用hive的MR功能，那么请选择hive1相应版本，否则的话选哪个都可以进行测试。</p>
<h1 id="配置hive"><a href="#配置hive" class="headerlink" title="配置hive"></a>配置hive</h1><ol>
<li>下载完hive后，解压，然后<code>sudo vi /etc/profile</code>编辑文件，添加环境变量</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HIVE_HOME=hive目录的绝路路径</span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$HIVE_HOME</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> HIVE_HOME PATH</span><br></pre></td></tr></table></figure>
<ol>
<li><p>控制台输入<code>source /etc/profile</code>使环境变量生效。</p>
</li>
<li><p>进入$HIVE_HOME/conf目录，拷贝<code>hive-default.xml.template</code>并重命名为<code>hive-site.xml</code>，编辑：（如果没有该参数，请自行添加，存在则改之）</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.exec.scratchdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span> <span class="comment">&lt;!--hdfs目录 hive目录需要手动创建,并改为777权限--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Scratch space for Hive jobs<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span> <span class="comment">&lt;!--hdfs目录，需要手动创建--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>location of default database for the warehouse<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://localhost:3306/hive?createDatabaseIfNotExist=true<span class="tag">&lt;/<span class="name">value</span>&gt;</span> <span class="comment">&lt;!--修改为自己的mysql数据库--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>JDBC connect string for a JDBC metastore<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>Driver class name for a JDBC metastore<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span> <span class="comment">&lt;!--mysql用户名--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>username to use against metastore database<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span> <span class="comment">&lt;!--mysql密码--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>password to use against metastore database<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>然后查找value是<code>${system</code>开头的，替换成具体的本地绝对路径，可以创建一个hive用户，放到hive用户目录下。</p>
</li>
<li><p>拷贝<code>hive-env.sh.template</code>并重命名<code>hive-env.sh</code>，添加如下内容，注意环境变量值更换为自己的路径。</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HADOOP_HOME=/home/hadoop/hadoop-2.7.1 </span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/<span class="built_in">local</span>/share/jdk1.8.0_73</span><br></pre></td></tr></table></figure>
<ol>
<li>将hive-site.xml拷贝一份到hadoop的配置目录。</li>
<li>下载mysql驱动放到hive目录下的lib目录中。</li>
<li>启动hive，控制台输入<code>hive</code>，如果正确则输出一段信息后进入hive交互模式。</li>
</ol>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><ol>
<li><blockquote>
<p>Caused by: org.datanucleus.store.rdbms.connectionpool.DatastoreDriverNotFoundException: The specified datastore driver (“com.mysql.jdbc.Driver”) was not found in the CLASSPATH. Please check your CLASSPATH specification, and the name of the driver.</p>
</blockquote>
<p> <strong>解决方法</strong>：下载mysql驱动放到hive的lib目录</p>
</li>
<li><blockquote>
<p>org.apache.hadoop.security.AccessControlException: Permission denied: user=hive, access=WRITE, inode=”/tmp/hadoop-yarn/staging/hive/.staging”:hadoop:supergroup:drwxr-xr-x</p>
</blockquote>
<p> <strong>解决方法</strong>：在hdfs中创建tmp目录，并改为777权限。</p>
</li>
<li><blockquote>
<p>Starting Job = job_1457683200911_0001, Tracking URL = <a href="http://10.10.1.110:8088/proxy/application_1457683200911_0001/" target="_blank" rel="external">http://10.10.1.110:8088/proxy/application_1457683200911_0001/</a><br>Kill Command = /home/hadoop/hadoop-2.7.1/bin/hadoop job  -kill job_1457683200911_0001<br>Hadoop job information for Stage-1: number of mappers: 0; number of reducers: 0，打开管理页面发现信息：waiting for AM container to be allocated, launched and register with RM.</p>
</blockquote>
<p> <strong>解决方法</strong>：yarn没有配置正确，没有启动<code>nodemanager</code>，启动命令<code>yarn-daemon.sh start nodemanager</code>，启动之后即可运行job。</p>
</li>
</ol>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol>
<li><a href="http://blog.csdn.net/jyf211314/article/details/34110721" target="_blank" rel="external">hadoop2.2完全分布式集群+hive+mysql存储元数据配置</a>排版有点乱，请将就看</li>
<li><a href="http://blog.csdn.net/z363115269/article/details/39048589" target="_blank" rel="external">hive导入HDFS数据</a> 和上面毛病类似</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hadoop/">hadoop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hdfs/">hdfs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hive/">hive</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-spring/SpingXD结合Hadoop" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/spring/SpingXD结合Hadoop/" class="article-date">
      <time datetime="2016-03-11T04:34:40.000Z" itemprop="datePublished">2016-03-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/spring/SpingXD结合Hadoop/">SpingXD结合Hadoop</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前的文章介绍了<a href="/Spring-XD简介">Spring XD</a>，<a href="/以分布式方式运行Spring-XD">以分布式方式运行Spring-XD</a>和<a href="/安装启动Hadoop集群">安装启动Hadoop集群</a>的文章。本文将简单介绍（刚学，很LOW(⊙﹏⊙)b）SpringXD和Hadoop，HDFS结合配置和使用方法。</p>
<h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><p>已经按照上述提到的两篇文章或者其他资料搭建并运行了SpringXD和Hadoop。</p>
<h1 id="配置SpringXD"><a href="#配置SpringXD" class="headerlink" title="配置SpringXD"></a>配置SpringXD</h1><ol>
<li>运行命令<code>jps</code>找到<code>AdminServerApplication</code>和<code>ContainerServerApplication</code>两项，结束进程<code>kill 进程pid</code>。</li>
<li>编辑SpingXD的配置文件<code>server.yaml</code>，在<code>spring</code>节点下增加以下hadoop的配置信息：</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">hadoop:</span></span><br><span class="line">	&lt;!-- 注意换成自己的hdfs地址 --<span class="string">&gt;</span><br><span class="line"></span><span class="attr">    fsUri:</span> hdfs://<span class="number">10.10</span><span class="number">.1</span><span class="number">.110</span>:<span class="number">8020</span></span><br><span class="line"><span class="attr">    resourceManagerHost:</span> <span class="number">10.10</span><span class="number">.1</span><span class="number">.110</span></span><br><span class="line"><span class="attr">    resourceManagerPort:</span> <span class="number">8032</span></span><br><span class="line"><span class="attr">    yarnApplicationClasspath:</span></span><br></pre></td></tr></table></figure>
<p>然后启动xd-admin<code>bin/xd-admin</code>和xd-container<code>bin/xd-container</code>。</p>
<ol>
<li>切换到hadoop用户下，使用命令<code>hadoop fs -mkdir /xd</code>创建目录，然后更改权限<code>hadoop fs -chmod -R 777 /xd</code>（如果没有配置hadoop的环境变量，则请进入hadoop的目录使用<code>bin/hadoop</code>命令代替<code>hadoop</code>）</li>
<li>打开新的控制台，进入xd-shell交互环境，假如根据上面的Spring-XD配置文章配置了安全措施，那么还需要执行下面的命令<code>admin config server --uri http://xd-adminIP:9393 --username 用户名 --password 密码</code>进行授权后登录。</li>
<li>创建stream，向hdfs中写入数据<code>stream create --name myhdfsstream1 --definition &quot;time | hdfs&quot; --deploy</code>，用命令<code>hadoop fs ls /xd/myhdfsstream1</code>即可看到有临时文件生成。</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/spring/">spring</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hadoop/">hadoop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hdfs/">hdfs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/">spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring-xd/">spring xd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring-xd/">spring-xd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xd/">xd</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-other/Hexo-Git-Oschina-Golang-Tenxcloud打造博客" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/other/Hexo-Git-Oschina-Golang-Tenxcloud打造博客/" class="article-date">
      <time datetime="2016-03-09T15:17:00.000Z" itemprop="datePublished">2016-03-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/other/Hexo-Git-Oschina-Golang-Tenxcloud打造博客/">Hexo+Git+Oschina+Golang+Tenxcloud打造博客</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p><em>Hexo</em> 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。具体使用方法<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="external">参见这里</a></p>
<p><em>Git</em> 介绍和使用<a href="http://gitref.org/zh/index.html" target="_blank" rel="external">参见这里</a></p>
<p><em>OSCina</em> 开源信息平台，这里指的是<a href="http://git.oschina.net/" target="_blank" rel="external">其下的Git托管平台</a></p>
<p><em>Golang</em> 谷歌开发的一款跨平台的语言，<a href="golang.org">官方地址</a>在国内无法打开，<a href="http://golangtc.com/" target="_blank" rel="external">golangtc</a>是一个Golang学习网站，可以自行查阅。</p>
<p><em>TenxCloud</em> 也就是<a href="https://www.tenxcloud.com/" target="_blank" rel="external">时速云</a>，是国内最早的容器云平台之一(Container as a service)，提供丰富的容器化应用，镜像构建与发布，弹性可伸缩的容器服务，以及灵活、高性能的容器主机管理。容器化应用包括但不限于云主机，云数据库，大数据，Web应用等。</p>
<h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><ol>
<li>安装hexo</li>
<li>安装Golang，并配置Golang环境</li>
<li>安装Git，并配置相关环境变量</li>
</ol>
<h1 id="创建Git仓库"><a href="#创建Git仓库" class="headerlink" title="创建Git仓库"></a>创建Git仓库</h1><p>打开<a href="http://git.oschina.net/" target="_blank" rel="external">开源中国Git托管平台</a>，(注册后)登录，点击右上角<code>+</code>号，新建项目，输入项目名，描述，如果不想公开的话，可以选择私有，其余默认即可，点击创建。然后克隆到本地。命令行切换到刚才克隆的项目根目录，输入<code>hexo init</code>，hexo博客初始化完成。输入<code>hexo generate</code>可以渲染页面，生成静态页面，默认是在public文件夹。hexo默认初始化忽略了public文件夹，我们需要修改<code>.gitignore</code>文件，删除public的记录，这样保证可以同步到git仓库中。</p>
<h1 id="编写Golang-Server服务"><a href="#编写Golang-Server服务" class="headerlink" title="编写Golang Server服务"></a>编写Golang Server服务</h1><p>在项目根目录创建一个叫<code>server.go</code>的文件，把下面的代码考入即可。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"net/http"</span></span><br><span class="line">	<span class="string">"log"</span></span><br><span class="line">	<span class="string">"os/exec"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">	fs := http.FileServer(http.Dir(<span class="string">"public"</span>))</span><br><span class="line">	http.Handle(<span class="string">"/"</span>, fs)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//用于git的webhook，触发pull</span></span><br><span class="line">	http.HandleFunc(<span class="string">"/_blog/_pull"</span>, <span class="keyword">func</span>(writer http.ResponseWriter, request *http.Request) &#123;</span><br><span class="line">		cmd := exec.Command(<span class="string">"git"</span>,<span class="string">"pull"</span>)</span><br><span class="line">		<span class="keyword">if</span> err:=cmd.Start(); err!=<span class="literal">nil</span> &#123;</span><br><span class="line">			log.Println(<span class="string">"git pull error"</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	err := http.ListenAndServe(<span class="string">":80"</span>, <span class="literal">nil</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatal(<span class="string">"ListenAndServe: "</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过git提交文件到远程。</p>
<h1 id="创建容器"><a href="#创建容器" class="headerlink" title="创建容器"></a>创建容器</h1><p>这里之所以选择时速云，是因为一开始接触这类最早的就是这个平台，所以使用的还算熟悉。下面我们就在上面创建一个容器。</p>
<ol>
<li>登录之后，<a href="https://hub.tenxcloud.com/repos/sdvdxl/golang" target="_blank" rel="external">选择这个镜像</a>，此镜像集成了Git，Golang，SSH服务，点击右侧部署镜像按钮。如下图配置：<br><img src="/images/other/2016-03-09_2351.png" alt="配置">，点击创建按钮，等待片刻即可创建成功。</li>
<li><a href="https://console.tenxcloud.com/containers?0" target="_blank" rel="external">返回容器服务</a>，切换到北京2区，可以看到我们刚才创建的容器服务，点击如图所示的图标，进入控制台：<br><a href="/images/other/2016-03-09_2355.png">进入控制台</a>。</li>
<li>进入控制台后，使用git命令<code>git clone 之前创建的git仓库地址</code>，克隆完后，进入项目目录，输入<code>go build server.go</code>，然后输入<code>./server &amp;</code>运行服务端。</li>
<li>现在打开容器服务视图，找到我们创建的容器，点击右侧的查看所有服务地址，点击协议为<code>HTTP</code>的那个服务地址，在打开的页面中即可看到我们的博客内容。</li>
<li>点击绑定域名，绑定80端口域名，我们就可以通过自己的域名访问了。</li>
</ol>
<h1 id="设置WebHooks"><a href="#设置WebHooks" class="headerlink" title="设置WebHooks"></a>设置WebHooks</h1><p>打开开源中国git平台，找到刚创建的项目，点击右侧的管理，然后点击左侧的WebHooks，URL输入<code>http://你的域名/_blog/_pull</code>，Push和合并请求打上勾，然后提交。</p>
<h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><ol>
<li>不要选择杭州区的服务，因为采用的是阿里云服务，所以会导致没有备案的域名没法打开。</li>
<li>本博客公开托管在<a href="http://git.oschina.net/sdvdxl/blog" target="_blank" rel="external">开源中国的Git服务上</a>，大家可以fork之后改动后用作自己的博客平台。</li>
<li>方便起见，Golang脚本已经编译成了<code>Windows</code> <code>Mac</code> <code>Linux</code> 各平台的32和64位版本，无需编译server.go文件了，可以直接选择相应平台文件进行运行，启动web服务。</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/other/">other</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/博客/">博客</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-hadoop/安装启动Hadoop集群" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/hadoop/安装启动Hadoop集群/" class="article-date">
      <time datetime="2016-03-09T09:49:43.000Z" itemprop="datePublished">2016-03-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/hadoop/安装启动Hadoop集群/">安装启动Hadoop集群</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>UCloud云主机，2.6.32-431.11.15.el6.ucloud.x86_64<br>假设三台主机内网IP分别为10.10.1.10, 10.10.1.11和10.10.1.12，hostname分别为：10-10-1-10,10-10-1-11和10-10-1-12</p>
<h1 id="配置JDK"><a href="#配置JDK" class="headerlink" title="配置JDK"></a>配置JDK</h1><p>本次搭建测试用的是jdk8，可以从<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="external">Oracle官网下载</a>对应的版本。</p>
<h2 id="配置jdk"><a href="#配置jdk" class="headerlink" title="配置jdk"></a>配置jdk</h2><p>假设jdk解压后目录存放在<code>/usr/local/jdk8</code>，命令行输入<code>sudo vi /etc/profile</code>，添加一下内容：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/usr/<span class="built_in">local</span>/jdk8</span><br><span class="line">CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/jre/lib</span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br></pre></td></tr></table></figure></p>
<p>然后输入<code>source /etc/profile</code>使环境变量生效，输入<code>java -version</code>有java版本信息输出说明配置成功，三台主机均这么配置。</p>
<h1 id="配置hadoop用户"><a href="#配置hadoop用户" class="headerlink" title="配置hadoop用户"></a>配置hadoop用户</h1><p>控制台输入<code>sudo useradd -m -U hadoop</code> 添加hadoop用户，然后输入<code>sudo passwd hadoop</code> 修改hadoop用户的密码，输入<code>su -l hadoop</code>，输入刚才设置的密码，切换到hadoop用户。</p>
<h1 id="配置ssh"><a href="#配置ssh" class="headerlink" title="配置ssh"></a>配置ssh</h1><p>前提是已经切换到hadoop用户。<br>在每个主机控制台输入<code>ssh-keygen</code>回车，一直回车直到结束。最后在master主机上使用<code>ssh-copy-id</code>命令拷贝认证信息到本主机和其他两台主机，这样可以免密码登录。<code>ssh-copy-id hadoop@主机地址</code>，注意本机地址不要使用localhost和127.0.0.1，请使用局域网ip，在这里是10.10.1.10。</p>
<h1 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h1><p>以修改10.10.1.10主机为例，在控制台输入<code>sudo vi /etc/hosts</code>，在内容中添加一下信息：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 10-10-128-53</span><br><span class="line">10.10.248.115 10-10-248-115</span><br><span class="line">10.10.227.51 10-10-227-51</span><br></pre></td></tr></table></figure></p>
<p>注意，千万不要配置<code>10.10.1.10 10-10-1-10</code>本主机ip映射本主机名的条目，否则会造成主机间无法监听。其余两台参照这个也进行配置。</p>
<h1 id="配置Hadoop"><a href="#配置Hadoop" class="headerlink" title="配置Hadoop"></a>配置Hadoop</h1><ol>
<li><a href="http://hadoop.apache.org/releases.html" target="_blank" rel="external">下载Hadoop</a>，这里下载的是<code>2.7.1</code>版本。控制输入<code>wget http://www.apache.org/dyn/closer.cgi/hadoop/common/hadoop-2.7.1/hadoop-2.7.1.tar.gz</code>，等待下载完成。</li>
<li>控制台输入<code>tar -xvf hadoop-2.7.1.tar.gz</code>解压，会生成<code>hadoop-2.7.1</code>目录。</li>
<li>输入<code>cd hadoop-2.7.1/etc/hadoop</code>进入配置文件目录。</li>
<li>修改<code>hadoop-env.sh</code>中的<code>export JAVA_HOME=</code>，将等号后的内容改成上面配置的jdk绝对路径，在这里就是<code>/usr/local/jdk8</code>，修改完后应该是<code>export JAVA_HOME=/usr/local/jdk8</code>，保存退出。</li>
<li>修改<code>core-site.xml</code>，配置config内容：</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/hadoop/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Abase for other temporary directories.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 注意，这里改成自己本机的ip --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://10.10.1.10:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.default.namenode<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 注意，这里改成自己本机的ip --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://10.10.1.10:8082<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>io.file.buffer.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.native.lib<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Should native hadoop libraries, if present, be used.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol>
<li>修改<code>hdfs-site.xml</code>，修改config内容为：</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.nameservices<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop-cluster1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 注意修改为自己的ip --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10.10.1.10:50090<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/hadoop/dfs/name<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/hadoop/dfs/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.webhdfs.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol>
<li>修改<code>yarn-site.xml</code></li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 注意ip改为自己的 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10.10.1.10:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10.10.1.10:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10.10.1.10:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.admin.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10.10.1.10:8033<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10.10.1.10:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol>
<li>修改<code>mapred-site.xml</code></li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobtracker.http.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10.10.128.53:50030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10.10.128.53:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10.10.128.53:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol>
<li>修改<code>slaves</code>文件，添加其他两台ip</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10.10</span>.1.11</span><br><span class="line"><span class="number">10.10</span>.1.12</span><br></pre></td></tr></table></figure>
<p>将hadoop目录覆盖到其余机器对应目录。<br>下面开始操作hadoop命令，如果遇到hadoop native错误，请查看文末<code>Hadoop Native 配置</code>部分。</p>
<ol>
<li>格式化文件系统<br>注意：这里的格式化文件系统并不是硬盘格式化，只是针对主服务器hdfs-site.xml的dfs.namenode.name.dir和dfs.datanode.data.dir目录做相应的清理工作。切换到Hadoop的home目录，执行<code>bin/hdfs namenode -format</code>。</li>
<li>启动停止服务<br>启动<code>sbin/start-dfs.sh</code>，可以一次性启动master和slaves节点服务。<code>sbin/start-yarn.sh</code>启动yarn资源管理服务。要停止服务，用对应的<code>sbin/stop-dfs.sh</code>和<code>sbin/stop-dfs.sh</code>即可停止服务。</li>
<li>单独启动一个datanode<br>增加节点或者重启节点，需要单独启动，则可使用以下命令:<br><code>sbin/hadoop-daemon.sh start datanode</code>，启动nodeManager<code>sbin/yarn-daemon.sh start nodemanager</code>，当然也可以操作namenode<code>sbin/hadoop-daemon.sh start namenode</code> <code>sbin/yarn-daemon.sh start resourcemanager</code>。<br><strong>注意</strong>：原文中是<code>sbin/yarn-daemons.sh</code>和<code>sbin/hadoop-daemons.sh</code>，运行后发现并没有启动成功，去掉s后启动成功。</li>
</ol>
<h1 id="Hadoop-Native-配置"><a href="#Hadoop-Native-配置" class="headerlink" title="Hadoop Native 配置"></a>Hadoop Native 配置</h1><p>输入  <code>hadoop checknative</code> 检查Hadoop本地库版本和相关依赖信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">16/03/10 12:17:56 DEBUG util.NativeCodeLoader: Trying to load the custom-built native-hadoop library...</span><br><span class="line">16/03/10 12:17:56 DEBUG util.NativeCodeLoader: Failed to load native-hadoop with error: java.lang.UnsatisfiedLinkError: /home/hadoop/hadoop-2.6.3/lib/native/libhadoop.so.1.0.0: /lib64/libc.so.6: version `GLIBC_2.14&apos; not found (required by /home/hadoop/hadoop-2.6.3/lib/native/libhadoop.so.1.0.0)</span><br><span class="line">16/03/10 12:17:56 DEBUG util.NativeCodeLoader: java.library.path=/home/hadoop/hadoop-2.6.3/lib/native</span><br><span class="line">16/03/10 12:17:56 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</span><br><span class="line">16/03/10 12:17:56 DEBUG util.Shell: setsid exited with exit code 0</span><br><span class="line">Native library checking:</span><br><span class="line">hadoop:  false</span><br><span class="line">zlib:    false</span><br><span class="line">snappy:  false</span><br><span class="line">lz4:     false</span><br><span class="line">bzip2:   false</span><br><span class="line">openssl: false</span><br><span class="line">16/03/10 12:17:56 INFO util.ExitUtil: Exiting with status 1</span><br></pre></td></tr></table></figure>
<p>发现<code>/lib64/libc.so.6: version</code>GLIBC_2.14’ not found`信息，说明该版本的Hadoop需要glibc_2.14版本。下面就安装所需的版本。</p>
<ol>
<li><code>mkdir glib_build &amp;&amp; cd glib_build</code></li>
<li><code>wget http://ftp.gnu.org/gnu/glibc/glibc-2.14.tar.gz &amp;&amp; wget http://ftp.gnu.org/gnu/glibc/glibc-linuxthreads-2.5.tar.bz2</code></li>
<li><code>tar zxf glibc-2.14.tar.gz &amp;&amp; cd glibc-2.14 &amp;&amp; tar jxf ../glibc-linuxthreads-2.5.tar.bz2</code></li>
<li><code>cd ../ &amp;&amp; export CFLAGS=&quot;-g -O2&quot; &amp;&amp; ./glibc-2.14/configure --prefix=/usr --disable-profile --enable-add-ons --with-headers=/usr/include --with-binutils=/usr/bin</code></li>
<li><code>make</code></li>
<li><code>make install</code><br>install最后会遇到错误信息：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">CC=&quot;gcc -B/usr/bin/&quot; /usr/bin/perl scripts/test-installation.pl /root/</span><br><span class="line">/usr/bin/ld: cannot find -lnss_test1</span><br><span class="line">collect2: ld returned 1 exit status</span><br><span class="line">Execution of gcc -B/usr/bin/ failed!</span><br><span class="line">The script has found some problems with your installation!</span><br><span class="line">Please read the FAQ and the README file and check the following:</span><br><span class="line">- Did you change the gcc specs file (necessary after upgrading from</span><br><span class="line">  Linux libc5)?</span><br><span class="line">- Are there any symbolic links of the form libXXX.so to old libraries?</span><br><span class="line">  Links like libm.so -&gt; libm.so.5 (where libm.so.5 is an old library) are wrong,</span><br><span class="line">  libm.so should point to the newly installed glibc file - and there should be</span><br><span class="line">  only one such link (check e.g. /lib and /usr/lib)</span><br><span class="line">You should restart this script from your build directory after you&apos;ve</span><br><span class="line">fixed all problems!</span><br><span class="line">Btw. the script doesn&apos;t work if you&apos;re installing GNU libc not as your</span><br><span class="line">primary library!</span><br><span class="line">make[1]: *** [install] Error 1</span><br><span class="line">make[1]: Leaving directory `/root/glibc-2.14&apos;</span><br><span class="line">make: *** [install] Error 2</span><br></pre></td></tr></table></figure>
<p>无需关注，检验是否成功<br><code>ls -l /lib64/libc.so.6</code><br>lrwxrwxrwx 1 root root 12 Mar 10 12:12 /lib64/libc.so.6 -&gt; libc-2.14.so<br>出现了<code>/lib64/libc.so.6 -&gt; libc-2.14.so</code>字样说明成功了。</p>
<p>安装openssl<br><code>yum install openssl-static.x86_64</code></p>
<h1 id="如何修改主机名称"><a href="#如何修改主机名称" class="headerlink" title="如何修改主机名称"></a>如何修改主机名称</h1><p>修改文件<code>/etc/sysconfig/network</code><br>然后执行<code>/etc/rc.d/init.d/network restart</code>重启网络模块</p>
<h1 id="secondaryNameNode-配置"><a href="#secondaryNameNode-配置" class="headerlink" title="secondaryNameNode 配置"></a>secondaryNameNode 配置</h1><ol>
<li>修改masters文件（如果没有则自己创建），添加一个主机名称，用以作为secondaryNameNode。</li>
<li>修改hdfs-site.xml的内容，删除<code>dfs.namenode.secondary.http-address</code>部分配置，添加新的配置（注意修改为自己的ip）：</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.http.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>10.10.1.10:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">		The address and the base port where the dfs namenode web ui will listen on.</span><br><span class="line">		If the port is 0 then the server will start on a free port.</span><br><span class="line">	<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>10.10.1.11<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h6 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h6><ol>
<li><a href="http://blog.csdn.net/tang9140/article/details/42869531" target="_blank" rel="external">Hadoop-2.5.2集群安装配置详解</a></li>
<li><a href="http://blog.csdn.net/zzu09huixu/article/details/36873669" target="_blank" rel="external">基于hadoop2.2的namenode与SecondaryNameNode分开配置在不同的计算机</a></li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hadoop/">hadoop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hdfs/">hdfs</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-spring/Spring-XD简介" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/spring/Spring-XD简介/" class="article-date">
      <time datetime="2016-03-09T07:30:24.000Z" itemprop="datePublished">2016-03-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/spring/Spring-XD简介/">Spring-XD简介</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>Spring XD is a unified, distributed, and extensible service for data ingestion, real time analytics, batch processing, and data export.<br><img src="/images/xd/xd-overview.png" alt="distributed-overview."></p>
<h1 id="Streams"><a href="#Streams" class="headerlink" title="Streams"></a>Streams</h1><p>翻译过来就是流，通过定义stream可以控制数据的流向，比如从MongoDB读取数据然后存储到HDFS中。<br><img src="/images/xd/stream.png" alt="stream"></p>
<h2 id="创建方式"><a href="#创建方式" class="headerlink" title="创建方式"></a>创建方式</h2><p>一个简单的示例：该示例创建一个名字叫<code>ticktock</code>的stream，每秒钟产生一条时间信息然后通过管道传送到log中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xd:&gt; stream create --definition &quot;time | log&quot; --name ticktock</span><br></pre></td></tr></table></figure></p>
<h2 id="销毁Stream"><a href="#销毁Stream" class="headerlink" title="销毁Stream"></a>销毁Stream</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xd:&gt; stream destroy --name stream-name</span><br></pre></td></tr></table></figure>
<h1 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h1><p>模块，当前包含<code>source</code>, <code>sink</code>,<code>processor</code>, 和<code>job</code>。</p>
<h1 id="Souces"><a href="#Souces" class="headerlink" title="Souces"></a>Souces</h1><p>数据源，Stream的来源，有以下几种方式：</p>
<table>
<thead>
<tr>
<th>方式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>File</td>
<td>文件方式</td>
</tr>
<tr>
<td>FTP</td>
<td>FTP方式</td>
</tr>
<tr>
<td>GemFire Continuous Query(gemfire-cq)</td>
<td>GemFire查询</td>
</tr>
<tr>
<td>GemFire source(gemfire)</td>
<td>GemFire文件</td>
</tr>
<tr>
<td>HTTP</td>
<td>http方式</td>
</tr>
<tr>
<td>JDBC Source(jdbc)</td>
<td>关系型数据库jdbc</td>
</tr>
<tr>
<td>JMS</td>
<td>JMS</td>
</tr>
<tr>
<td>Kafka</td>
<td>Kafka消息队列</td>
</tr>
<tr>
<td>Mail</td>
<td>通过接收电子邮件</td>
</tr>
<tr>
<td>MongoDB Source(mongodb)</td>
<td>MongoDB数据库</td>
</tr>
<tr>
<td>MQTT</td>
<td>MQTT</td>
</tr>
<tr>
<td>RabbitMQ</td>
<td>RabbitMQ消息队列</td>
</tr>
<tr>
<td>Reactor IP(reactor-ip)</td>
<td>Reactor IP(reactor-ip)</td>
</tr>
<tr>
<td>SFTP</td>
<td>SFTP</td>
</tr>
<tr>
<td>Stdout Capture</td>
<td>标准输入</td>
</tr>
<tr>
<td>Syslog</td>
<td>系统日志</td>
</tr>
<tr>
<td>Tail</td>
<td>Tail程序</td>
</tr>
<tr>
<td>TCP</td>
<td>TCP</td>
</tr>
<tr>
<td>TCP Client(tcp-client)</td>
<td>TCP 客户端</td>
</tr>
<tr>
<td>Time</td>
<td>时间</td>
</tr>
<tr>
<td>Trigger Source(trigger)</td>
<td>触发器</td>
</tr>
<tr>
<td>Twitter Search(twittersearch)</td>
<td>Twitter搜索</td>
</tr>
<tr>
<td>Twitter Stream(twitterstream)</td>
<td>Twitter Stream流</td>
</tr>
</tbody>
</table>
<h1 id="Sinks"><a href="#Sinks" class="headerlink" title="Sinks"></a>Sinks</h1><p>数据源，Stream的输出，有以下几种方式：</p>
<table>
<thead>
<tr>
<th>方式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Dynamic Router(router)</td>
<td>动态路由</td>
</tr>
<tr>
<td>File Sink(file)</td>
<td>文件方式</td>
</tr>
<tr>
<td>FTP Sink(ftp)</td>
<td>FTP方式</td>
</tr>
<tr>
<td>GemFire Server</td>
<td>GemFire服务器</td>
</tr>
<tr>
<td>GPFDIST</td>
<td>GPFDIST</td>
</tr>
<tr>
<td>Cassandra</td>
<td>Cassandra 数据库</td>
</tr>
<tr>
<td>Hadoop(HDFS) (hdfs)</td>
<td>hdfs文件系统</td>
</tr>
<tr>
<td>HDFS Dataset(Avro/Parquet) (hdfs-dataset)</td>
<td>hdfs文件系统中的avro或者parquet类型文件</td>
</tr>
<tr>
<td>JDBC Source(jdbc)</td>
<td>关系型数据库jdbc</td>
</tr>
<tr>
<td>Kafka Sink (kafka)</td>
<td>Kafka消息队列</td>
</tr>
<tr>
<td>Log</td>
<td>log 文件</td>
</tr>
<tr>
<td>Mail</td>
<td>Mail 发送</td>
</tr>
<tr>
<td>Mongo</td>
<td>Mongo数据库</td>
</tr>
<tr>
<td>MQTT Sink (mqtt)</td>
<td>MQTT</td>
</tr>
<tr>
<td>Null Sink(null)</td>
<td>null</td>
</tr>
<tr>
<td>RabbitMQ</td>
<td>RabbitMQ 消息队列</td>
</tr>
<tr>
<td>Redis</td>
<td>Redis</td>
</tr>
<tr>
<td>Shell Sink (shell)</td>
<td>shell</td>
</tr>
<tr>
<td>Splunk Server (splunk)</td>
<td>splunk</td>
</tr>
<tr>
<td>TCP Sink (tcp)</td>
<td>TCP</td>
</tr>
</tbody>
</table>
<h1 id="Processors"><a href="#Processors" class="headerlink" title="Processors"></a>Processors</h1><p>可用的处理器包括<code>Aggregator</code> <code>Filter</code> <code>Header Enricher</code> <code>HTTP Client</code> <code>JSON to Tuple</code> <code>Object to JSON</code> <code>Script</code> <code>Shell Command</code> <code>Splitter</code> <code>Transform</code></p>
<ul>
<li>Aggregator – 作用和 splitter相反，用于聚合，</li>
<li>Splitter – 用于拆解</li>
<li>Filter – 过滤器，用于中间处理数据</li>
<li>Header Enricher (header-enricher) – 用于添加头部信息</li>
<li>HTTP Client – 通过httpClient方式发送URL请求</li>
<li>JSON to Tuple (json-to-tuple) – 转换json数据到Tuple类型</li>
<li>Object to JSON (object-to-json) – 将对象转换为json格式</li>
<li>Script 用于加载Groovy脚本</li>
<li>Shell – 用于加载Shell脚本</li>
<li>Transform – 用于负载类型转换</li>
</ul>
<h1 id="Taps"><a href="#Taps" class="headerlink" title="Taps"></a>Taps</h1><p>监听器，窃听器。<br>不用重复定义相同的stream，然后监听此stream就可以做其他操作。并且可以用Label来分别对每个部分内容做个别名，定义Tab时候可以使用别名。如<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stream create foo --definition &quot;httpLabel: http | fLabel: filter --expression=payload.startsWith(&apos;A&apos;) | flibble: transform --expression=payload.toLowerCase() | log&quot; --deploy</span><br><span class="line">stream create fooTap --definition &quot;tap:stream:foo.flibble &gt; log&quot; --deploy</span><br></pre></td></tr></table></figure></p>
<p>上面对trasfrom部分做了一个别名，叫做<code>flibble</code>，然后下面定义一个Tap，并且最后指定是flibble这个标签，那么就是对<code>foo</code>这个stream的<code>flibble</code>做监听。</p>
<h1 id="Jobs"><a href="#Jobs" class="headerlink" title="Jobs"></a>Jobs</h1><p>Job相比Stream不同点在于，Job算是静态的，Stream是动态的。Stream会持续接收数据，处理数据；Job是一次性接收数据，处理数据，如果数据改变，那么是不会进行处理的，除非有定时任务。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">job create --name jobtest --definition &apos;timestampfile --directory=D:/jobs&apos; --deploy</span><br><span class="line">stream create --name time-cron --definition &quot;trigger --cron=&apos;* * * * * *&apos; &gt; queue:job:jobtest&quot; --deploy</span><br></pre></td></tr></table></figure></p>
<h1 id="使用counter"><a href="#使用counter" class="headerlink" title="使用counter"></a>使用counter</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">stream create foo --definition &apos;http --outputType=application/json | log&apos;</span><br><span class="line">stream create countName --definition &apos;tap:stream:foo &gt; field-value-counter --fieldName=name&apos; --deploy</span><br><span class="line">stream deploy --name foo</span><br><span class="line">http post --data &#123;&quot;name&quot;:&quot;a&quot;&#125;</span><br><span class="line">http post --data &#123;&quot;name&quot;:&quot;a&quot;&#125;</span><br><span class="line">http post --data &#123;&quot;name&quot;:&quot;b&quot;&#125;</span><br></pre></td></tr></table></figure>
<p><code>field-value-counter list</code> 列出field-value-counter的名字<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FieldValueCounter name</span><br><span class="line">----------------------</span><br><span class="line">countName</span><br></pre></td></tr></table></figure></p>
<p><code>field-value-counter display --name countName</code> 列出名字为<code>countName</code>的描述</p>
<pre><code>FieldValueCounter=countName
---------------------------  -  -----
VALUE                        -  COUNT
a                            |  2
b                            |  1
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/spring/">spring</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/">spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring-xd/">spring xd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring-xd/">spring-xd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xd/">xd</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-spring/以分布式方式运行Spring-XD" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/spring/以分布式方式运行Spring-XD/" class="article-date">
      <time datetime="2016-03-09T06:18:33.000Z" itemprop="datePublished">2016-03-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/spring/以分布式方式运行Spring-XD/">以分布式方式运行Spring-XD</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><em>主要以官方文档说明进行配置</em></p>
<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>Spring XD分布式运行环境（DIRT）支持以分布式方式运行多个跨节点的任务。参见<a href="http://docs.spring.io/spring-xd/docs/1.3.1.RELEASE/reference/html/#getting-started" target="_blank" rel="external">Getting Started</a>获取以单个节点运行方式的信息。</p>
<p>XD的分布式运行架构主要由以下组件构成：</p>
<ul>
<li>Admin 主要用于管理Stream，Job的发布，用户操作，和提供运行时相关的状态，系统统计和分析的REST服务</li>
<li>Container 托管发布的模块（Stream处理任务）和批量任务</li>
<li>ZooKeeper 提供所有XD运行时的信息。追踪Container信息，如：modules，jobs发布情况，steam定义，发布状态等。</li>
<li>Spring Batch Job Repository Database –这个要求要配置一个关系型数据库。XD包含了HSQLDB，但是不推荐用在生产环境中。XD支持任何JDBC型数据库。</li>
<li>A Message Broker –用于数据传输。XD的数据传输模块设计成了插拔式。当前XD版本支持<code>Rabbit MQ</code>和<code>Redis</code>，这两个都支持stream和job过程产生的数据的传输，<code>Kafka</code>仅支持steam产生的数据传输。请注意：job使用Kafka作为数据传输是不稳定的。这个项目必须要配置一个作为数据传输的插件（推荐Redis）。</li>
<li>Analytics Repository – XD目前用Redis作为counters和gauges分析的存储方式。<br>XD的分布式运行环境概览如下：<br><img src="/images/xd/distributed-runtime-overview.png" alt="distributed-runtime-overview"></li>
</ul>
<h1 id="Server-Configuration"><a href="#Server-Configuration" class="headerlink" title="Server Configuration"></a>Server Configuration</h1><p>默认查找<code>$XD_HOME/config/servers.yml</code>文件，作为配置文件。<br>但是可以使用<code>XD_CONFIG_LOCATION</code>环境变量改变配置文件夹，使用<code>XD_CONFIG_NAME</code>改变配置文件位置，如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export XD_CONFIG_LOCATION=file:/xd/config/</span><br><span class="line">export XD_CONFIG_NAME=region1-servers</span><br></pre></td></tr></table></figure></p>
<ul>
<li>注意，<code>XD_CONFIG_LOCATION</code>最后的<code>/</code>是必须的。</li>
</ul>
<h1 id="Database-Configuration"><a href="#Database-Configuration" class="headerlink" title="Database Configuration"></a>Database Configuration</h1><p>MySQL，PostGresql选其中一个配置即可，当然还有Oracle也可以配置，但是在这里没有列出，可以<a href="http://docs.spring.io/spring-xd/docs/1.3.1.RELEASE/reference/html/#_database_configuration" target="_blank" rel="external">]参考官方文档</a><br><code>xd-singlenode</code>模式是使用了一个嵌入式<code>HSQLDB</code>数据库，运行分布式模式的时候，可以使用独立的<code>HSQLDB</code>，但是仅仅推荐在学习和开发的时候使用它，正式环境最好使用其他比如<code>MySQL</code>，<code>Postgres</code>等等数据库。</p>
<ul>
<li>注意：如果在stream模块中使用除了<code>Postgres</code>和<code>HSQLDB</code>数据库，那么需要把对应的驱动放到<code>$XD_HOME/lib</code>目录。<br><code>servers.yml</code>文件中已经注释了一部分jdbc配置信息，可以按需更改。</li>
</ul>
<h2 id="MySQL配置"><a href="#MySQL配置" class="headerlink" title="MySQL配置"></a><code>MySQL</code>配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">    datasource:</span><br><span class="line">    url: jdbc:mysql://yourDBhost:3306/yourDB</span><br><span class="line">    username: yourUsername</span><br><span class="line">    password: yourPassword</span><br><span class="line">    driverClassName: com.mysql.jdbc.Driver</span><br></pre></td></tr></table></figure>
<h2 id="Postgresql配置"><a href="#Postgresql配置" class="headerlink" title="Postgresql配置"></a>Postgresql配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  datasource:</span><br><span class="line">    url: jdbc:postgresql://yourDBhost:5432/yourDB</span><br><span class="line">    username: yourUsername</span><br><span class="line">    password: yourPassword</span><br><span class="line">    driverClassName: org.postgresql.Driver</span><br></pre></td></tr></table></figure>
<h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><p>stream和job的数据传输需要用到（Rabbit MQ也可以）（当用作数据分析时候也需要），这里推荐统一使用redis作为配置，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  redis:</span><br><span class="line">   port: 6379</span><br><span class="line">   host: localhost</span><br><span class="line">   pool:</span><br><span class="line">     maxIdle: 8 # max idle connections in the pool</span><br><span class="line">     minIdle: 0 # min idle connections in the pool</span><br><span class="line">     maxActive: -1 # no limit to the number of active connections</span><br><span class="line">     maxWait: 30000 # time limit to get a connection - only applies if maxActive is finite</span><br></pre></td></tr></table></figure></p>
<h3 id="安装redis"><a href="#安装redis" class="headerlink" title="安装redis"></a>安装redis</h3><p>从<a href="redis.io">官网</a>下载最新的redis，然后解压，进入redis根目录，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd deps</span><br><span class="line">make hiredis jemalloc linenoise lua</span><br><span class="line">cd ..</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p>
<p>注意：依赖于gcc和make（Ubuntu系列如果没有安装 apt-get install gcc make）</p>
<h1 id="开启页面登录密码保护"><a href="#开启页面登录密码保护" class="headerlink" title="开启页面登录密码保护"></a>开启页面登录密码保护</h1><p>默认ui管理界面是没有安全配置的，不需密码即可访问，为了安全起见，我们可以设置登录用户和密码。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  profiles: admin                                                     (1)</span><br><span class="line">security:</span><br><span class="line">  basic:</span><br><span class="line">    enabled: true                                                     (2)</span><br><span class="line">    realm: SpringXD                                                  </span><br><span class="line">  user:</span><br><span class="line">    name: yourAdminUsername</span><br><span class="line">    password: yourAdminPassword</span><br><span class="line">    role: ADMIN, VIEW, CREATE</span><br></pre></td></tr></table></figure></p>
<p>注意：<code>spring.batch.initializer.enabled</code>默认是true，会使Spring Bath初始化表结构。</p>
<h1 id="启动admin"><a href="#启动admin" class="headerlink" title="启动admin"></a>启动admin</h1><p>admin只会有一个，用来协调container和管理相关stream，job等。<br><code>xd/bin/xd-admin</code></p>
<h1 id="启动container"><a href="#启动container" class="headerlink" title="启动container"></a>启动container</h1><p>container可以启动多个，也就是组成多个节点，由此构成分布式运行环境。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xd/bin/xd-container</span><br></pre></td></tr></table></figure></p>
<h1 id="创建Stream"><a href="#创建Stream" class="headerlink" title="创建Stream"></a>创建Stream</h1><p>进入<code>$XD_HOME/shell/</code>,控制台输入<code>bin/xd-shell</code>，进去xd命令行交互模式，然后输入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stream create --name foo --definition &apos;time | log&apos; --deploy</span><br></pre></td></tr></table></figure></p>
<p>即可看见admin日志（控制台没关闭的话也可以看到）有时间信息输出。</p>
<p>下面这个stream是从kafka读取信息，然后传输到log里，所以需要配置kafka，请查阅kafka相关资料。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stream create --name kafkaDevice --definition &apos;kafka --outputType=text/plain --zkconnect=10.10.1.20:2181 --topic=kafka_test --offsetStorage=redis | log &apos; --deploy</span><br></pre></td></tr></table></figure>
<h1 id="末"><a href="#末" class="headerlink" title="末"></a>末</h1><p>最后贴出一份比较完整的配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">security:</span><br><span class="line">  basic:</span><br><span class="line">    enabled: true</span><br><span class="line">    realm: SpringXD</span><br><span class="line">  user:</span><br><span class="line">    name: hekr</span><br><span class="line">    password: hekr</span><br><span class="line">    # 必须配置角色才会生效</span><br><span class="line">    role: ADMIN, VIEW, CREATE</span><br><span class="line">spring:</span><br><span class="line">    redis:</span><br><span class="line">       port: 6379</span><br><span class="line">       host: 127.0.0.1</span><br><span class="line">       pool:</span><br><span class="line">          maxIdle: 8 # max idle connections in the pool</span><br><span class="line">          minIdle: 0 # min idle connections in the pool</span><br><span class="line">          maxActive: -1 # no limit to the number of active connections</span><br><span class="line">          maxWait: 30000 # time limit to get a connection - only applies if maxActive is finite</span><br><span class="line">       #sentinel:</span><br><span class="line">       #   master: mymaster</span><br><span class="line">       #   nodes: 127.0.0.1:26379,127.0.0.1:26380,127.0.0.1:26381</span><br><span class="line">    batch:</span><br><span class="line">        isolationLevel: ISOLATION_SERIALIZABLE</span><br><span class="line">        # clobType:</span><br><span class="line">        dbType: MYSQL</span><br><span class="line">        maxVarcharLength: 2500</span><br><span class="line">        tablePrefix: BATCH_</span><br><span class="line">        validateTransactionState: true</span><br><span class="line">        initializer:</span><br><span class="line">          enabled: true</span><br><span class="line">    datasource:</span><br><span class="line">        url: jdbc:mysql://localhost:3306/xd</span><br><span class="line">        username: root</span><br><span class="line">        password: hekr</span><br><span class="line">        driverClassName: com.mysql.jdbc.Driver</span><br><span class="line">        testOnBorrow: true</span><br><span class="line">        validationQuery: select 1</span><br><span class="line">zk:</span><br><span class="line">  namespace: xd</span><br><span class="line">  client:</span><br><span class="line">     connect: 10.10.1.20:2181</span><br><span class="line">     sessionTimeout: 60000</span><br><span class="line">     connectionTimeout: 30000</span><br><span class="line">     initialRetryWait: 1000</span><br><span class="line">     retryMaxAttempts: 3</span><br><span class="line">xd:</span><br><span class="line">    transport: redis</span><br></pre></td></tr></table></figure>
<p>##注意：</p>
<ol>
<li>配置权限后，进入xd-shell会显示<code>server-unknown:&gt;</code>， 需要配置一下admin server才能进入交互</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin config server --uri http://服务器地址:端口(默认9393) --username 用户名 --password 密码</span><br></pre></td></tr></table></figure>
<ol>
<li><code>testOnBorrow</code>默认是<code>true</code>，如果配置为true或者没有配置，则需要配置正确的<code>validationQuery</code>，如果配置不正确则会有类似如下异常出现<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Command failed org.springframework.xd.rest.client.impl.SpringXDException: Could not get JDBC Connection; nested exception is java.sql.SQLException: Failed to validate a newly established connection.</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/spring/">spring</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/">spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring-xd/">spring xd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring-xd/">spring-xd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xd/">xd</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-java/Jrebel插件配置参数" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/java/Jrebel插件配置参数/" class="article-date">
      <time datetime="2016-03-09T06:10:18.000Z" itemprop="datePublished">2016-03-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/java/Jrebel插件配置参数/">Jrebel插件配置参数</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="JVM-参数"><a href="#JVM-参数" class="headerlink" title="JVM 参数"></a>JVM 参数</h1><p><code>-javaagent:/path/jrebel.jar</code></p>
<h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1><h2 id="Spring-Bean-Core-MVC-Security-Webflow-WS"><a href="#Spring-Bean-Core-MVC-Security-Webflow-WS" class="headerlink" title="Spring Bean/Core/MVC/Security/Webflow/WS"></a>Spring Bean/Core/MVC/Security/Webflow/WS</h2><p><code>-Drebel.spring_plugin=true</code></p>
<h2 id="Spring-Data"><a href="#Spring-Data" class="headerlink" title="Spring Data"></a>Spring Data</h2><p><code>-Drebel.spring_data_plugin=true</code></p>
<h2 id="Struts"><a href="#Struts" class="headerlink" title="Struts"></a>Struts</h2><p><code>-Drebel.struts2_plugin=true</code></p>
<h1 id="Hibernate"><a href="#Hibernate" class="headerlink" title="Hibernate"></a>Hibernate</h1><p><code>-Drebel.hibernate_plugin=true</code></p>
<h1 id="Hibernate-Validator"><a href="#Hibernate-Validator" class="headerlink" title="Hibernate Validator"></a>Hibernate Validator</h1><p><code>-Drebel.hibernate_validator_plugin=true</code></p>
<h1 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a>MyBatis</h1><p><code>-Drebel.mybatis_plugin=true</code></p>
<h1 id="Logback"><a href="#Logback" class="headerlink" title="Logback"></a>Logback</h1><p><code>-Drebel.logback_plugin=true</code></p>
<h1 id="Log4J-2"><a href="#Log4J-2" class="headerlink" title="Log4J 2"></a>Log4J 2</h1><p><code>-Drebel.log4j2_plugin=true</code></p>
<p>#Groovy<br><code>-Drebel.groovy_plugin=true</code></p>
<h1 id="Jruby"><a href="#Jruby" class="headerlink" title="Jruby"></a>Jruby</h1><p><code>-Drebel.jruby_plugin=true</code></p>
<h1 id="GWT"><a href="#GWT" class="headerlink" title="GWT"></a>GWT</h1><p><code>-Drebel.gwt_plugin=true</code></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="http://manuals.zeroturnaround.com/jrebel/misc/frameworks.html" target="_blank" rel="external">plugins</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/java/">java</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jrebel/">jrebel</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-linux/archlinux安装ntfs驱动" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/linux/archlinux安装ntfs驱动/" class="article-date">
      <time datetime="2016-03-09T06:08:56.000Z" itemprop="datePublished">2016-03-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/linux/archlinux安装ntfs驱动/">archlinux安装ntfs驱动</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>默认情况下，archlinux本身支持挂在ntfs文件系统，只不过是只读，不能写入。如果要支持ntfs系统文件，那么需要安装ntfs的驱动程序。<br>用命令 <code>yaourt -Ss ntfs</code> 可以查找关于ntfs的软件包<br>&gt;<br>extra/ntfs-3g 2014.2.15-1 [installed]<br>    NTFS filesystem driver and utilities<br>aur/disk-manager 1.0.1-3 (56)<br>    A tool to manage filesystems, partitions, and NTFS write mode<br>aur/fgetty 0.7-5 (14)<br>    A mingetty stripped of the printfs<br>aur/fgetty-pam 0.7-4 (4)<br>    A mingetty stripped of the printfs, patched for PAM-support.<br>aur/grub4dos 0.4.5c_20140822-1 (35)<br>    A GRUB boot loader support menu on windows(fat,ntfs)/linux(ext2,3,4)<br>aur/libntfs-wii 2013.1.13-1 (1)<br>    NTFS-3G filesystem access library (for Nintendo Gamecube/Wii homebrew<br>    development)<br>aur/ntfs-3g-ar 2014.2.15AR.3-1 (37)<br>    NTFS filesystem driver and utilities with experimental features<br>aur/ntfs-3g-fuse 2014.2.15-1 (46)<br>    Stable read and write NTFS driver and ntfsprogs. This package will allow<br>    normal users to mount NTFS Volumes.<br>aur/ntfs-3g_ntfsprogs-git 4695.db35a16-1 (7)<br>    Read and write NTFS driver and utilities - GIT version<br>aur/ntfs-config 1.0.1-13 (119)<br>    Enable/disable NTFS write support with a simple click<br>aur/ntfsfixboot 1.0-3 (18)<br>    Fix NTFS boot sector<br>aur/scrounge-ntfs 0.9-2 (28)<br>    Data recovery program for NTFS file systems<br>aur/ufsd-module 8.9.0-3 (9)<br>    Paragon NTFS &amp; HFS for Linux driver. - ACLs removed<br>aur/ufsd-module-dkms 8.9.0-3 (4)<br>    Paragon NTFS &amp; HFS for Linux driver. - ACLs removed. DKMS version<br>aur/wipefreespace 2.0-1 (3)<br>    Securely wipe the free space on an ext2/3/4,NTFS, XFS,ReiserFSv3,<br>    ReiserFSv4, FAT12/16/32,Minix,JFS and HFS+ partition or drive</p>
<p>可以看到有这么多相关软件包，其实只需要安装第一个也就是 <code>extra/ntfs-3g</code> 就可以了，输入命令 <code>yaourt -S extra/ntfs-3g</code>，安装完毕后重新插入ntfs分区U盘或者移动硬盘就可以进行写入操作了。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/linux/">linux</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/arch/">arch</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/archlinux/">archlinux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ntfs/">ntfs</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-linux/archlinux安装" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/linux/archlinux安装/" class="article-date">
      <time datetime="2016-03-09T06:05:03.000Z" itemprop="datePublished">2016-03-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/linux/archlinux安装/">archlinux安装</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本人也是第一次安装archlinux，严格来说是第一次安装成功，记录一下，既为自己也为新手。此方式是非UEFI模式，并且分区表使DOS的MBR方式，GPT分区表没有测试。以后也许会在虚拟机中测试过进行补充。</p>
<h1 id="温馨提示"><a href="#温馨提示" class="headerlink" title="温馨提示"></a>温馨提示</h1><p>建议现在虚拟机中安装几次，直到安装成功，并且可以正常开机，上网，打开桌面环境，有十足把握之后再在物理机上安装，以免中间出现问题又没办法解决。并在虚拟机安装的过程中记录遇到的问题，以便日后参考。同时安装的时候记得备份重要文件，以免安装错误导致文件丢失。</p>
<h1 id="准备安装介质"><a href="#准备安装介质" class="headerlink" title="准备安装介质"></a>准备安装介质</h1><ol>
<li>首先准备archlinux镜像，如果没有可以<a href="https://www.archlinux.org/download/" target="_blank" rel="external">点击这里下载</a>，最好选择中国的镜像服务，比如<a href="http://mirrors.163.com/archlinux/iso/2015.01.01/" target="_blank" rel="external">网易的</a>。下载完成后校验一下MD5值（官方文件的MD5值在md5sums.txt 这个文件中），如果相同那么可以进行下一步了；如果不相同需要重新下载并校验，不推荐在MD5值不同的情况下继续进行，因为不知道会发生什么问题。</li>
<li>刻录至U盘。如果用的是linux系统或者Mac系统（话说这么优雅的系统为啥要换呢，也可能是双系统吧），可以使用 <code>dd</code> 命令。把U盘插入计算机， 输入命令 <code>ls -al /dev/sd*</code>, 一般sdb是你的U盘，也请先做好文件备份。 现在假定U盘是 /dev/sdb, archlinux的文件路径是 /home/user/archlinux.iso,那么输入命令(需root权限) <code>dd -if=/home/user/archlinux.iso -of=/dev/sdb</code>，然后等待命令执行完毕，如果没有任何提示，则代表成功了。</li>
</ol>
<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>   <strong> 再次提醒，做好文件备份 </strong></p>
<ol>
<li>如果没有分区的话，先进行分区，并进行格式化，如果已经操作过了或者想重用上次系统(Linux)的分区，可以直接进入第2步。<ul>
<li>分区进行时：<br>敲入命令 <code>fdisk /dev/sda</code> (假定操作的磁盘时sda，请自行确认好，此操作要格外小心)。输入 <code>m</code> 可以查看帮助， <code>n</code> 是新建一个分区， <code>d</code> 是删除一个已有分区。如果想新建一个DOS分区表，则输入 <code>o</code>，已经有分区表，想重新分区的话，按 <code>d</code> ，直到删除所有分区。分区方案可以按照以下来： <code>/boot</code>  大概需要  <code>200M</code>， <code>/</code> 可以分配 <code>15G</code> ～ <code>40G</code>， <code>/var</code> <code>8G</code>～ <code>20G</code> (可选)  ， <code>/tmp</code> <code>4G</code> ～ <code>8G</code> (可选)，其余分给 <code>/home</code>分区（强烈建议单独分区，以后重装系统可以不用拷贝主目录下的资料了）， <code>swap</code> <code>4G</code> ～ <code>8G</code>（可选）。新建分区输入 <code>n</code>，默认（p主分区）即可，然后默认（分区号1），接下来也是默认扇区既可以，然后选择大小，可以输入G,M,K单位的大小，我们输入 <code>+200M</code>，确定；然后创建根分区，按<code>n</code>,一路下来，大小选择输入 <code>+15G</code>,确定，根分区创建完成。如果分区少于4个，可以按照上面步骤，直到分区创建完成；但是如果分区多于4个，就要创建扩展分区，然后再创建逻辑分区了。扩展分区的创建和上面一样，只不过在选择分区格式的时候不是输入 <code>p</code> 了，而是 <code>e</code>，其余一样的。创建逻辑分区的时候输入 <code>l</code> （英文L的小写字母），剩下的步骤也是和创建主分区一样的啦。所有分区创建完成后，输入 <code>w</code> ，上面的一系列操作才会真正写入磁盘，再次之前都是在内存中，所以，在按 <code>w</code> 之前，还是有后悔药吃的，但是按下之后，那就定格了。切记！</li>
<li>格式化分区：<br>格式化分区的命令是 <code>mkfs.xxx</code>，输入 <code>mkfs.</code>，按 <code>Tab</code> 键可以看到有如下格式：  <code>mkfs.bfs</code>       <code>mkfs.ext2</code>      <code>mkfs.ext4</code>      <code>mkfs.jfs</code>       <code>mkfs.reiserfs</code> <code>mkfs.cramfs</code>    <code>mkfs.ext3</code>      <code>mkfs.ext4dev</code>  <code>mkfs.minix</code>     <code>mkfs.xfs</code>。咦，好像没有swap分区格式，swap分区格式化的命令是 <code>mkswap</code> 啦。输入命令 <code>mkfs.ext4 /dev/sda1</code> 将 <code>/boot</code> 分区格式化成ext4格式的分区，根分区和其他非swap分区用此方法依次格式化，用 <code>mkswap /dev/sdax</code> 格式化上面分的swap分区，x是分swap分区所得的号码。</li>
</ul>
</li>
</ol>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ol>
<li>mount 相关分区。 <code>mkdir /mnt/home /mnt/tmp /mnt/var /mnt/boot</code>  创建home，tmp，var，boot挂载点目录，然后 <code>mount /dev/sdax /mnt/xx</code> x代表分区号，xx代表目录，把的分区挂载到相应挂载点上。</li>
<li><p>修改 <code>/etc/pacman.d/mirrorlist</code> 的镜像列表，可以删除所有的，然后输入<br>&gt;<br>Server = <a href="http://mirrors.163.com/archlinux/$repo/os/x86_64" target="_blank" rel="external">http://mirrors.163.com/archlinux/$repo/os/x86_64</a></p>
<p>   保存退出。</p>
<ol>
<li>执行 <code>pacstrap /mnt base</code> 命令进行基础安装。</li>
<li>生成fstab。 <code>genfstab -p /mnt &gt;&gt; /mnt/etc/fstab</code>, 查看一下/mnt/etc/fstab 内容格式是否正确，有无重复内容，如有请先订正。格式大体如下：<br>&gt;<br>#<br># /etc/fstab: static file system information<br>#<br># <file system="">    <dir>    <type>    <options>    <dump>    <pass><br># UUID=ee8bae58-9428-4917-b63e-0258d19a4567<br>/dev/sda5               /             ext4          rw,relatime,data=ordered0 1<br># UUID=cbac48fe-3345-4cba-96ec-acdbdc56d0ad<br>/dev/sda9               /home         ext4          rw,relatime,data=ordered0 2<br># UUID=59e210c2-fced-4cdd-b631-d9a50ba82312<br>/dev/sda7               /tmp          ext4          rw,relatime,data=ordered0 2</pass></dump></options></type></dir></file></li>
<li>切换到新系统的root目录下，命令  <code>arch-choot /mnt</code></li>
<li>设置主机名 <code>echo your_hostname &gt; /etc/hostname</code> ， your_hostname换成你想要的，最好是纯英文。</li>
<li>设置时区。 <code>ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code>。</li>
<li>修改 <code>/etc/locale.gen</code> ， 添加以下内容<br>&gt;<br>en_US.UTF-8 UTF-8<br>zh_CN.UTF-8 UTF-8</li>
</ol>
<p>执行 <code>locale-gen</code>，</p>
<ol>
<li>执行 <code>echo LANG=zh_CN.UTF-8 &gt; /etc/locale.conf</code></li>
<li>设置键盘映射和字体，文件在 <code>/etc/vconsole.conf</code>，在这就保持默认配置了。</li>
<li>设置root密码 <code>passwd</code> 然后输入密码，再输入一次确认。</li>
<li>安装引导程序，这里用grub。 <code>pacman -Sy grub</code>，安装完成后，执行  <code>pacman-db-upgrade</code>， 然后再执行 <code>grub-install --target=i386-pc --recheck --debug /dev/sda</code> 安装grub引导到sda上。最后执行 <code>grub-mkconfig -o /boot/grub/grub.cfg</code> ，生成引导配置。</li>
<li>重启， 执行 <code>reboot</code>。如果成功安装的话，会出现grub引导选择系统菜单，选择默认的进入，输入root用户名，输入密码，登录成功。至此，安装已经完成，接下来是配置。</li>
</ol>
</li>
</ol>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><ol>
<li><p>网络配置</p>
<ul>
<li>查看网络设备名称 <code>ls /sys/class/net</code>, 记住所看到的网卡接口名称，假定叫做eth0</li>
<li>启用网络接口 ip link set eth0 up</li>
<li>检查结果状态 <code>ip link show dev eth0</code> 如果打印<br>&gt;<br>enp3s0: <broadcast,multicast,up,lower_up> mtu 1500 qdisc fq_codel state UP mode DEFAULT    group default qlen 1000<br>link/ether 00:e0:66:cb:e2:1e brd ff:ff:ff:ff:ff:ff</broadcast,multicast,up,lower_up></li>
</ul>
<p>类似内容，说明启用成功。</p>
</li>
<li>创建或编辑 <code>/etc/systemd/network/dhcp.network</code> ,添加以下内容：<br>&gt;<br>[Match]<br>Name=en*<br>[Network]<br>DHCP=v4</li>
</ol>
<ol>
<li>启用网络服务 <code>systemctl enable systemd-resolved</code></li>
<li><p>编辑 <code>/etc/resolv.conf</code> 配置dns ， 添加以下内容：<br>&gt;<br>nameserver 8.8.8.8<br>nameserver 4.4.4.4</p>
<p>如果你的IP段在192.168.xxx.yyy,则再添加 nameserver 192.168.xxx.1</p>
</li>
<li><p>执行 <code>dhcpd</code> 启用dhcp，要开机自动启动dhcp服务，则执行 <code>systemctl enable dhcpd</code><br>基本环境配置已经完成。</p>
</li>
</ol>
<h1 id="桌面环境配置"><a href="#桌面环境配置" class="headerlink" title="桌面环境配置"></a>桌面环境配置</h1><p>安装 fxce4</p>
<p>pacman -S xorg xorg-server<br>pacman -S slim #登录管理器<br>pacman -S xfce4<br>pacman -S xfce4-goodies<br>pacman -S fortune-mode<br>pacman -S gamin</p>
<ol>
<li>创建用户 <code>useradd -Um du</code></li>
<li>设置密码 <code>passwd du</code></li>
<li>切换用户  <code>su -l du</code></li>
<li>输入 <code>startxfce4</code> 可以进入xfce桌面了</li>
</ol>
<h1 id="美化显示："><a href="#美化显示：" class="headerlink" title="美化显示："></a>美化显示：</h1><ul>
<li><p>字体</p>
<ol>
<li>首先可以从windowns上或者其他地方准备字体文件，然后 <code>cp *.ttf ~/.fonts/</code></li>
<li>建立字体缓存<br><code>mkfontscale</code><br><code>mkfontdir</code><br><code>fc-cache -fv</code></li>
</ol>
</li>
<li><p>输入法 <a href="https://wiki.archlinux.org/index.php/Fcitx_%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29#.E8.BE.93.E5.85.A5.E6.B3.95.E6.A8.A1.E5.9D.97" target="_blank" rel="external">传送门</a><br>输入法就安装fcitx小企鹅输入法了</p>
<ol>
<li><p>安装输入法</p>
<p> <code>pacman -S fcitx</code>  </p>
</li>
<li>配置输入法<br> 安装输入法其他模块<br> <code>fcitx-ui-light</code> Fcitx 的轻量 UI.<br><code>fcitx-fbterm</code> Fbterm 对 Fcitx 的支持。<br><code>fcitx-table-extra</code> Fcitx 的一些额外码表支持，包括仓颉 3, 仓颉 5, 粤拼, 速成, 五笔, 郑码等等<br><code>fcitx-table-other</code> Fcitx 的一些更奇怪的码表支持，包括 Latex, Emoji, 以及一大堆不明字符等等。<br><code>kcm-fcitx</code> KDE 的 Fcitx 输入法模块</li>
<li>启动桌面环境时候启用输入法<br> 在 .bashrc 文件中加入如下代码<br> &gt;<br>export GTK_IM_MODULE=fcitx<br>export QT_IM_MODULE=fcitx<br>export XMODIFIERS=”@im=fcitx”</li>
</ol>
<p>退出用户，重新登陆，可以欢快的使用输入法了。</p>
</li>
</ul>
<p>ps:<br>浙大源：<code>Server = http://mirrors.zju.edu.cn/archlinux/$repo/os/$arch</code><br>网易源：<code>Server = http://mirrors.163.com/archlinux/$repo/os/x86_64</code><br>北京交大：<code>Server = http://mirror.bjtu.edu.cn/ArchLinux/$repo/os/x86_64</code></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/linux/">linux</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/arch/">arch</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/archlinux/">archlinux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2016 杜龙少
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >访客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>